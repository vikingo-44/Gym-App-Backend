(()=>{"use strict";var e={1621:(e,t,r)=>{e.exports=r.p+"static/media/wallpaper.5870441109ea69e72de9.jpg"},2836:(e,t,r)=>{e.exports=r.p+"static/media/logoND.030bafb231722e429e72.jpg"},4180:(e,t,r)=>{var a=r(1396),o=r(6665),n=r(3668),l=r(3929),i=r(530),s=r(1243),d=r(7538),c=r(3225),u=r(5259),m=r(1704),g=r(6283),f=r(4307),p=r(4701),b=r(8180),h=r(5648),y=r(1690),C=r(8264),E=r(6773),x=r(996),B=r(7109);const w={isDark:!1,colors:{background:"#F0F4F8",card:"#FFFFFF",textPrimary:"#1F2937",textSecondary:"#6B7280",inputBackground:"#FFFFFF",inputBorder:"#D1D5DB",primary:"#007AFF",primaryDark:"#005ACF",success:"#10B981",danger:"#FF3B30",warning:"#FF9500",divider:"#E5E7EB",highlight:"#D1E7FF"}},A={isDark:!0,colors:{background:"#121212",card:"#1F2937",textPrimary:"#F9FAFB",textSecondary:"#D1D5DB",inputBackground:"#374151",inputBorder:"#4B5563",primary:"#60A5FA",primaryDark:"#3B82F6",success:"#34D399",danger:"#F87171",warning:"#FDE047",divider:"#374151",highlight:"#3B4D63"}},S=(0,o.createContext)(Object.assign({},A,{toggleTheme:()=>{}})),k=()=>(0,o.useContext)(S),T=({children:e})=>{const t=(0,s.default)(),[r,a]=(0,o.useState)("dark"),n="dark"===("system"===r?t:r)?A:w,l=()=>{a(e=>"system"===e?"dark"===t?"light":"dark":"dark"===e?"light":"dark")},i=(0,o.useMemo)(()=>Object.assign({},n,{toggleTheme:l,manualScheme:r}),[n,l,r]);return o.createElement(S.Provider,{value:i},e)};var v=r(1259),z=r(2301),I=r(5624),D=r(9988),P=r(286),R=r(8403),W=r(5600),F=r(441),N=r(4164),j=r(5573),L=r(1965),O=r(5290),$=r(2557),V=r(5915),H=r(630),_=r(1631);const G="https://gym-app-backend-e9bn.onrender.com",M=(r(2836),e=>{if(!e)return null;const t=e.split(/[-\/]/);if(3===t.length){let e,r,a;4===t[0].length?[e,r,a]=t:[a,r,e]=t;return new Date(parseInt(e),parseInt(r)-1,parseInt(a))}return null}),q=e=>{if(!e)return"N/A";let t=e instanceof Date?e:M(e);return t&&!isNaN(t.getTime())?new Intl.DateTimeFormat("es-AR",{year:"numeric",month:"2-digit",day:"2-digit"}).format(t):"Inv\xe1lida"},U=e=>{if(!e)return"";if(e instanceof Date){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}const t=M(e);if(t&&!isNaN(t.getTime())){return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}return""},J=({assignment:e,assignmentStyles:t,themeColors:r,handleEditAssignment:a})=>{const[n,i]=(0,o.useState)(!1),s=e.routine.exercise_links?e.routine.exercise_links.length:0;let d,c;e.routine.routine_group?.fecha_vencimiento&&M(e.routine.routine_group.fecha_vencimiento)<new Date?(d=r.danger,c="VENCIDA"):e.is_active?(d=r.success,c="ACTIVA"):(d=r.warning,c="INACTIVA");return o.createElement(l.default,{style:t.assignmentCard},o.createElement(l.default,{style:[t.statusBar,{backgroundColor:d}]},o.createElement(g.default,{style:[t.statusText,{color:"VENCIDA"===c?r.card:"black"}]},c)),o.createElement(l.default,{style:t.assignmentContent},o.createElement(l.default,{style:t.assignmentHeader},o.createElement(l.default,{style:t.assignmentDetails},o.createElement(g.default,{style:t.routineName},e.routine.nombre),o.createElement(g.default,{style:{marginTop:5,color:r.textSecondary,fontSize:13,fontWeight:"500"}},s," EJERCICIOS")),o.createElement(l.default,{style:t.assignmentActions},o.createElement(h.default,{style:[t.editButton,{marginRight:8}],onPress:()=>a(e.routine_id)},o.createElement(v.default,{size:20,color:"black"})),o.createElement(h.default,{style:[t.editButton,{backgroundColor:n?r.textSecondary:"#3ABFBC"}],onPress:()=>i(!n)},n?o.createElement(z.default,{size:20,color:r.card}):o.createElement(I.default,{size:20,color:r.card})))),n&&o.createElement(l.default,{style:t.exerciseListContainer},o.createElement(g.default,{style:{fontSize:13,fontWeight:"bold",color:r.textPrimary,marginBottom:5}},"Detalle de Ejercicios:"),e.routine.exercise_links.sort((e,t)=>e.order-t.order).map((e,a)=>e.exercise?o.createElement(l.default,{key:e.id||a,style:t.exerciseItem},o.createElement(g.default,{style:t.exerciseName},e.order,". ",e.exercise.nombre),o.createElement(l.default,{style:t.detailsRow},o.createElement(l.default,{style:t.detailItem},o.createElement(g.default,{style:t.detailLabel},"Sets:"),o.createElement(g.default,{style:t.detailValue},e.sets)),o.createElement(l.default,{style:t.detailItem},o.createElement(g.default,{style:t.detailLabel},"Reps:"),o.createElement(g.default,{style:t.detailValue},e.repetitions)),o.createElement(l.default,{style:t.detailItem},o.createElement(g.default,{style:t.detailLabel},"Peso:"),o.createElement(g.default,{style:t.detailValue},e.peso||"-")))):o.createElement(g.default,{key:e.id||a,style:{color:r.danger}},"Error: Ejercicio no cargado.")))))};function Y({groupData:e,onComplete:t,onCancel:r,fetchCurrentAssignments:a}){const{colors:n}=k(),i=X(n),s=Object.assign({},i.label,{color:"white",fontSize:18,fontWeight:"bold",marginBottom:10}),{getToken:d}=(0,o.useContext)(Fe),c=e.assignments[0],u=e.expiryDate?q(e.expiryDate):"",[m,b]=(0,o.useState)(e.groupName||""),[C,x]=(0,o.useState)(e.assignments.length),[w,A]=(0,o.useState)(u),[S,T]=(0,o.useState)(!1),v=n.isDark?n.textSecondary:"#6B7280";return o.createElement(p.default,{style:[i.container,{backgroundColor:"black"}]},o.createElement(l.default,{style:i.headerSelection},o.createElement(g.default,{style:i.wizardTitle},"Editar Grupo: ",e.groupName),o.createElement(h.default,{style:[i.customButton,i.buttonDanger,{minWidth:80}],onPress:r},o.createElement(g.default,{style:i.buttonText},"Cancelar"))),o.createElement(f.default,{contentContainerStyle:i.wizardContainer},o.createElement(g.default,{style:i.stepText},"Detalles del Grupo"),o.createElement(g.default,{style:s},"Nombre de la Agrupaci\xf3n:"),o.createElement(E.default,{style:i.wizardInput,placeholder:"Ej: Rutina Bloque B",placeholderTextColor:v,value:m,onChangeText:b}),o.createElement(g.default,{style:[s,{marginTop:20}]},"Cantidad de Rutinas (D\xedas):"),o.createElement(g.default,{style:i.warningTextCenter},"Si se aumenta, se crear\xe1n rutinas vac\xedas. Si se reduce, se eliminar\xe1n las rutinas con el d\xeda m\xe1s alto."),o.createElement(l.default,{style:i.routineCounter},o.createElement(h.default,{style:[i.counterButton,{backgroundColor:n.danger}],onPress:()=>x(e=>Math.max(1,e-1)),disabled:C<=1||S},o.createElement(D.default,{size:24,color:"black"})),o.createElement(g.default,{style:i.counterCountText},C),o.createElement(h.default,{style:[i.counterButton,{backgroundColor:"#3ABFBC"}],onPress:()=>x(e=>Math.min(5,e+1)),disabled:C>=5||S},o.createElement(P.default,{size:24,color:"black"}))),o.createElement(g.default,{style:[s,{marginTop:20}]},"Fecha de Vencimiento (DD/MM/AAAA):"),o.createElement(E.default,{style:i.wizardInput,placeholder:"DD/MM/AAAA",placeholderTextColor:v,value:w,onChangeText:A,keyboardType:"default",editable:!S}),o.createElement(g.default,{style:i.warningTextCenter},"Formato DD/MM/AAAA requerido."),o.createElement(l.default,{style:[i.wizardActions,{justifyContent:"center"}]},o.createElement(h.default,{style:[i.customButton,i.buttonPrimary,{opacity:S?.5:1,minWidth:160}],onPress:async()=>{if(!m.trim()||!w.trim())return void y.default.alert("Error","El nombre y la fecha de vencimiento son obligatorios.");if(!/^\d{2}[-/]\d{2}[-/]\d{4}$/.test(w.trim()))return void y.default.alert("Error","Debes ingresar una fecha de vencimiento v\xe1lida en formato DD/MM/AAAA.");const r=U(w.trim());if(!r)return void y.default.alert("Error","No se pudo convertir la fecha a un formato v\xe1lido para la API.");const o=M(w.trim()),n=new Date;if(n.setHours(0,0,0,0),o&&o.setHours(0,0,0,0),!o||o<=n)y.default.alert("Error","La fecha de vencimiento debe ser una fecha futura.");else{T(!0);try{const o={Authorization:`Bearer ${await d()}`},n=e.routineGroupId,l=e.assignments.length;if(await B.default.patch(`${G}/routine_groups/${n}`,{nombre:m.trim(),fecha_vencimiento:r},{headers:o}),C>l){const e=C-l;for(let t=1;t<=e;t++){const e=l+t;await B.default.post(`${G}/routines/group/${n}/day/${e}/student/${c.student_id}`,{nombre:`${m.trim()} - D\xeda ${e}`,descripcion:`Rutina D\xeda ${e} generada por edici\xf3n.`},{headers:o})}}else if(C<l){const t=l-C,r=e.assignments.sort((e,t)=>{const r=e.routine.nombre.match(/ - Dia (\d+)$/i)||e.routine.nombre.match(/ - D\xeda (\d+)$/i),a=t.routine.nombre.match(/ - Dia (\d+)$/i)||t.routine.nombre.match(/ - D\xeda (\d+)$/i),o=r?parseInt(r[1]):0;return(a?parseInt(a[1]):0)-o}),a=[];for(let e=0;e<t;e++){const t=r[e];t&&a.push(B.default.delete(`${G}/routines/${t.routine_id}`,{headers:o}))}await Promise.all(a)}y.default.alert("\xc9xito","Grupo actualizado correctamente. \xa1Recuerda recargar si editaste las rutinas individuales!"),a(),t()}catch(l){console.error("Error actualizando grupo:",l.response?l.response.data:l.message),y.default.alert("Error",`Fallo al actualizar el grupo. Detalle: ${l.response?.data?.detail||"Error de red/servidor."}`)}finally{T(!1)}}},disabled:S||!m.trim()||!w.trim()},o.createElement(g.default,{style:i.buttonText},S?"Guardando...":"Guardar Cambios")))))}function K({student:e,routines:t,onAssignmentComplete:r,onCancel:a,navigation:s}){const{colors:d,isDark:c}=k(),u=(m=d,n.default.create({scrollContainer:{flex:1,backgroundColor:"black"},container:{flex:1,padding:20,backgroundColor:"black",alignItems:"center"},title:{fontSize:22,fontWeight:"bold",marginBottom:20,color:"#3ABFBC",width:"100%",textAlign:"center"},subtitle:{fontSize:18,fontWeight:"600",color:"white",marginTop:20,marginBottom:15,width:"100%",borderBottomWidth:1,borderBottomColor:m.divider,paddingBottom:5},routineListContainer:{width:"100%",marginBottom:30},label:{fontSize:16,fontWeight:"600",color:"white",marginBottom:10},warning:{fontSize:16,color:m.warning,textAlign:"center",padding:10},backButtonTop:{width:"100%",marginBottom:20,alignItems:"center"},currentAssignmentList:{width:"100%",marginBottom:20},groupHeaderContainer:{width:"100%",paddingBottom:10,borderBottomWidth:2,borderBottomColor:"#3ABFBC",marginBottom:15},groupHeader:{fontSize:18,fontWeight:"bold",color:"white",marginBottom:5},groupDetails:{fontSize:14,fontWeight:"normal",color:"#A9A9A9",marginBottom:2},groupActions:{flexDirection:"row",justifyContent:"flex-start",gap:10,marginTop:10,flexWrap:"wrap"},groupActionButtonText:{color:"black",fontWeight:"bold",fontSize:12,marginLeft:5},toggleGroupButton:{flexDirection:"row",alignItems:"center",paddingVertical:8,paddingHorizontal:10,borderRadius:8},assignmentCard:{flexDirection:"row",backgroundColor:"#1C1C1E",borderRadius:10,marginBottom:10,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.8,shadowRadius:5,elevation:4,overflow:"hidden"},statusBar:{width:30,justifyContent:"center",alignItems:"center",paddingVertical:10},statusText:{fontSize:12,fontWeight:"bold",color:"black",transform:[{rotate:"-90deg"}],width:100,textAlign:"center"},assignmentContent:{flex:1},assignmentHeader:{padding:15,flexDirection:"row",justifyContent:"space-between",alignItems:"center",flex:1},assignmentDetails:{flex:1,paddingRight:10},assignmentActions:{flexDirection:"row",alignItems:"center",justifyContent:"flex-end"},deleteButton:{padding:8,backgroundColor:m.danger,borderRadius:8,flexDirection:"row",alignItems:"center"},editButton:{padding:8,backgroundColor:"#3ABFBC",borderRadius:8,flexDirection:"row",alignItems:"center"},routineName:{fontSize:18,fontWeight:"600",color:"white"},exerciseListContainer:{marginTop:15,paddingTop:10,paddingHorizontal:15,paddingBottom:5,borderTopWidth:1,borderTopColor:m.divider,backgroundColor:"black"},exerciseItem:{paddingLeft:10,paddingVertical:8,borderLeftWidth:2,borderLeftColor:"#3ABFBC",marginBottom:8,backgroundColor:"#1C1C1E",borderRadius:5},exerciseName:{fontSize:15,fontWeight:"700",color:"white",marginBottom:5},detailsRow:{flexDirection:"row",justifyContent:"flex-start",gap:15,marginTop:5},detailItem:{flexDirection:"row",alignItems:"center",backgroundColor:"black",borderRadius:6,paddingHorizontal:8,paddingVertical:4},detailLabel:{fontSize:12,color:"#A9A9A9",marginRight:4,fontWeight:"500"},detailValue:{fontSize:14,fontWeight:"bold",color:"#3ABFBC"},customButton:{paddingVertical:12,paddingHorizontal:20,borderRadius:10,alignItems:"center",justifyContent:"center",minWidth:100,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.5,shadowRadius:3,elevation:4},buttonPrimary:{backgroundColor:"#3ABFBC"},buttonSecondary:{backgroundColor:"#1C1C1E",borderColor:m.divider,borderWidth:1},buttonDanger:{backgroundColor:m.danger},buttonText:{fontSize:16,fontWeight:"bold",color:"black"},buttonTextSecondary:{fontSize:16,fontWeight:"bold",color:"white"},groupSeparator:{marginBottom:30,paddingBottom:20,borderBottomWidth:2,borderBottomColor:m.divider,borderStyle:"dotted"}}));var m;const[p,b]=(0,o.useState)(null),[C,E]=(0,o.useState)([]),[x,w]=(0,o.useState)(!0),{getToken:A}=(0,o.useContext)(Fe),S=async()=>{w(!0);try{const t={Authorization:`Bearer ${await A()}`},r=await B.default.get(`${G}/professor/assignments/student/${e.id}`,{headers:t}),a=Array.isArray(r.data)?r.data:[];E(a)}catch(t){t.response&&404===t.response.status?E([]):(console.error("Error al cargar asignaciones (Ruta Profesor):",t.response?t.response.data:t.message),y.default.alert("Error de Conexi\xf3n",`No se pudieron cargar las asignaciones. ${t.message}`))}finally{w(!1)}},T=e=>{s?s.navigate("RoutineEditScreen",{routineId:e}):y.default.alert("Error de Navegacion","No se pudo acceder a la pantalla de edicion.")};(0,o.useEffect)(()=>{S();return s.addListener("focus",()=>{S()})},[e.id,c]);const v=(()=>{const e={};for(const t of C){if(!t.routine||!t.routine.routine_group)continue;let r=t.routine.routine_group.nombre,a=t.routine.routine_group.fecha_vencimiento,o=t.routine.routine_group.created_at,n=t.routine.professor?.nombre,l=t.routine.routine_group.id;const i=`G-${l}`;e[i]||(e[i]={groupName:r,assignments:[],expiryDate:a,creationDate:o,professorCreatorName:n,routineGroupId:l}),e[i].assignments.push(t)}return e})();return p?o.createElement(Y,{groupData:p,onCancel:()=>b(null),onComplete:()=>b(null),fetchCurrentAssignments:S}):o.createElement(f.default,{style:u.scrollContainer},o.createElement(l.default,{style:u.container},o.createElement(g.default,{style:u.title},"Gestionar: ",e.nombre),o.createElement(l.default,{style:u.backButtonTop},o.createElement(h.default,{style:[u.customButton,u.buttonSecondary,{minWidth:160}],onPress:a},o.createElement(g.default,{style:u.buttonTextSecondary},"Volver al Panel"))),o.createElement(g.default,{style:u.subtitle},"Rutinas Asignadas Actualmente (",C.length,")"),x?o.createElement(i.default,{size:"small",color:"#3ABFBC",style:{marginBottom:15}}):o.createElement(l.default,{style:u.currentAssignmentList},Object.keys(v).length>0?Object.keys(v).map((t,r)=>{const a=v[t],n=a.assignments,i=a.routineGroupId,s=n.some(e=>e.is_active),c=i,m=r===Object.keys(v).length-1?{}:u.groupSeparator;return o.createElement(l.default,{key:t,style:m},o.createElement(l.default,{style:u.groupHeaderContainer},o.createElement(g.default,{style:u.groupHeader},a.groupName," (",n.length," Rutinas)"),a.creationDate&&o.createElement(g.default,{style:u.groupDetails},"Creado: ",q(a.creationDate)),o.createElement(g.default,{style:u.groupDetails},"Profesor: ",a.professorCreatorName||"N/A"),o.createElement(g.default,{style:u.groupDetails},"Vence: ",q(a.expiryDate)),c&&o.createElement(l.default,{style:u.groupActions},o.createElement(h.default,{style:[u.toggleGroupButton,{backgroundColor:s?d.warning:"#3ABFBC"}],onPress:()=>(async(e,t)=>{const r=!t;try{const t={Authorization:`Bearer ${await A()}`};await Promise.all(e.map(e=>B.default.patch(`${G}/assignments/${e.id}`,{is_active:r},{headers:t}))),y.default.alert("\xc9xito",`Grupo ${r?"activado":"inactivado"} correctamente. **Todas las rutinas est\xe1n ${r?"activas":"inactivas"}.**`),S()}catch(a){console.error("Error cambiando estado del grupo:",a.response?a.response.data:a.message),y.default.alert("Error",`Fallo al cambiar el estado del grupo. Detalle: ${a.response?.data?.detail||"Error de red/servidor."}`)}})(n,s)},s?o.createElement(R.default,{size:16,color:"black"}):o.createElement(W.default,{size:16,color:"black"}),o.createElement(g.default,{style:[u.groupActionButtonText,{color:"black"}]},s?"INACTIVAR GRUPO":"ACTIVAR GRUPO")),o.createElement(h.default,{style:u.deleteButton,onPress:()=>((t,r)=>{t&&y.default.alert("ELIMINAR ASIGNACIONES DE GRUPO",`\xbfEst\xe1s seguro de que quieres eliminar TODAS las asignaciones (D\xeda 1, D\xeda 2, etc.) del grupo: ${r} para ESTE ALUMNO?`,[{text:"Cancelar",style:"cancel"},{text:"Eliminar Asignaciones",style:"destructive",onPress:async()=>{try{const r=await A();await B.default.delete(`${G}/assignments/group/${t}/student/${e.id}`,{headers:{Authorization:`Bearer ${r}`}}),y.default.alert("\xc9xito","Grupo de asignaciones eliminado correctamente."),S()}catch(r){console.error("Error eliminando grupo:",r.response?r.response.data:r.message),y.default.alert("Error",`Fallo al eliminar el grupo. Detalle: ${r.response?.data?.detail||"Error de red/servidor."}`)}}}])})(c,a.groupName)},o.createElement(F.default,{size:20,color:d.card}),o.createElement(g.default,{style:u.groupActionButtonText},"ELIMINAR")))),n.sort((e,t)=>{const r=e.routine.nombre.match(/ - Dia (\d+)$/i)||e.routine.nombre.match(/ - D\xeda (\d+)$/i),a=t.routine.nombre.match(/ - Dia (\d+)$/i)||t.routine.nombre.match(/ - D\xeda (\d+)$/i);return(r?parseInt(r[1]):999)-(a?parseInt(a[1]):999)}).map(e=>o.createElement(J,{key:e.id.toString(),assignment:e,assignmentStyles:u,themeColors:d,handleEditAssignment:T})))}):o.createElement(g.default,{style:u.warning},"Este alumno no tiene rutinas asignadas."))))}const X=e=>n.default.create({container:{flex:1,backgroundColor:"black"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"black"},searchInput:{height:45,backgroundColor:"#1C1C1E",borderColor:"#1C1C1E",borderWidth:1,borderRadius:10,paddingHorizontal:15,fontSize:16,color:"white",marginHorizontal:20,marginTop:15,marginBottom:20},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:15,backgroundColor:"black",borderBottomWidth:1,borderBottomColor:e.divider,elevation:0},headerSelection:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:20,backgroundColor:"#1C1C1E",borderBottomWidth:1,borderBottomColor:e.divider},headerTitle:{fontSize:18,fontWeight:"bold",color:"white",flex:1,textAlign:"center"},titleSelection:{fontSize:22,fontWeight:"bold",color:"#3ABFBC"},headerButtons:{flexDirection:"row",gap:15},iconButton:{padding:8,borderRadius:8,justifyContent:"center",alignItems:"center",backgroundColor:"#1C1C1E"},actionSection:{paddingHorizontal:20,paddingVertical:15,backgroundColor:"#1C1C1E",borderBottomWidth:1,borderBottomColor:e.divider,alignItems:"flex-start"},subtitle:{fontSize:20,fontWeight:"bold",color:"white",marginBottom:10},listTitle:{fontSize:18,fontWeight:"bold",color:"white",paddingVertical:10,paddingHorizontal:20,backgroundColor:"black"},studentCard:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#1F2937",borderRadius:10,padding:15,marginBottom:10,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.8,shadowRadius:5,elevation:4,width:"100%"},studentName:{fontSize:18,fontWeight:"600",color:"white"},studentEmail:{fontSize:14,color:"#A9A9A9"},studentCardActions:{flexDirection:"row",gap:10},actionButton:{paddingVertical:8,paddingHorizontal:12,borderRadius:8,alignItems:"center",justifyContent:"center",minWidth:80},actionButtonText:{fontSize:13,fontWeight:"bold",color:"black"},fab:{position:"absolute",width:60,height:60,alignItems:"center",justifyContent:"center",right:20,bottom:20,backgroundColor:"#3ABFBC",borderRadius:30,elevation:8,shadowColor:"#3ABFBC",shadowOpacity:.8,shadowOffset:{width:0,height:4},shadowRadius:10},fabIcon:{color:"black"},warningTextCenter:{color:e.warning,textAlign:"center",padding:10},errorView:{flex:1,justifyContent:"center",alignItems:"center",padding:40,backgroundColor:"black"},errorTitle:{fontSize:26,fontWeight:"bold",color:e.danger,marginBottom:10},errorDetail:{fontSize:16,color:"#A9A9A9",textAlign:"center"},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.7)",justifyContent:"flex-start",alignItems:"flex-start"},menuContainer:{width:280,height:"100%",backgroundColor:"#1C1C1E",position:"absolute",left:0,top:0,shadowColor:"#000",shadowOffset:{width:2,height:0},shadowOpacity:1,shadowRadius:5,elevation:10},menuTitle:{fontSize:18,fontWeight:"bold",paddingVertical:15,marginBottom:10,borderBottomWidth:1,borderBottomColor:e.divider,color:"#3ABFBC",paddingHorizontal:15},menuItem:{paddingVertical:12,borderBottomWidth:1,borderBottomColor:e.divider,flexDirection:"row",alignItems:"center",gap:10,paddingHorizontal:15},menuItemClose:{position:"absolute",bottom:0,left:0,right:0,padding:15,backgroundColor:e.divider,alignItems:"center"},menuItemText:{fontSize:15,color:"white",fontWeight:"600"},menuItemTextLogout:{fontSize:15,color:e.danger,fontWeight:"600"},menuItemTextClose:{fontSize:15,color:"white",fontWeight:"600"},wizardContainer:{flexGrow:1,padding:20,width:"100%"},wizardTitle:{fontSize:24,fontWeight:"bold",color:"#3ABFBC",marginBottom:20,textAlign:"center"},wizardInput:{height:50,backgroundColor:"#1C1C1E",borderColor:e.divider,borderWidth:1,borderRadius:10,paddingHorizontal:15,fontSize:16,color:"white",marginBottom:20,width:"100%"},wizardActions:{flexDirection:"row",justifyContent:"space-between",marginTop:30},routineCounter:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:20,marginBottom:20,paddingVertical:10},counterButton:{padding:10,backgroundColor:"#3ABFBC",borderRadius:8},counterCountText:{fontSize:32,fontWeight:"bold",color:"white",width:60,textAlign:"center"},progressContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:30,paddingVertical:15,width:"100%"},progressStep:{flex:1,alignItems:"center",position:"relative"},progressConnectorBackground:{height:4,backgroundColor:e.divider,position:"absolute",top:20,zIndex:0},progressConnectorActive:{backgroundColor:"#3ABFBC"},progressCircle:{width:40,height:40,borderRadius:20,backgroundColor:"#1C1C1E",borderWidth:2,borderColor:e.divider,justifyContent:"center",alignItems:"center",zIndex:1},progressCircleActive:{borderColor:"#3ABFBC"},progressCircleDone:{backgroundColor:"#3ABFBC",borderColor:"#3ABFBC"},progressText:{marginTop:5,fontSize:12,color:e.textSecondary,fontWeight:"500"},customButton:{paddingVertical:12,paddingHorizontal:20,borderRadius:10,alignItems:"center",justifyContent:"center",minWidth:100,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.5,shadowRadius:3,elevation:4},buttonPrimary:{backgroundColor:"#3ABFBC"},buttonSecondary:{backgroundColor:"#1C1C1E",borderColor:e.divider,borderWidth:1},buttonDanger:{backgroundColor:e.danger},buttonText:{fontSize:16,fontWeight:"bold",color:"black"},buttonTextSecondary:{fontSize:16,fontWeight:"bold",color:"white"},dateInputContainer:{flexDirection:"row",alignItems:"center",height:50,backgroundColor:"#1C1C1E",borderColor:e.divider,borderWidth:1,borderRadius:10,paddingHorizontal:15,marginBottom:20,justifyContent:"space-between"},dateText:{fontSize:16,color:"white",fontWeight:"500",flex:1},modalContent:{backgroundColor:"#1C1C1E",borderRadius:10,padding:20,width:"80%",alignSelf:"center",marginTop:"30%",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.5,shadowRadius:4,elevation:5},datePickerInputGroup:{flexDirection:"row",justifyContent:"space-between",marginBottom:20,gap:10},datePickerInput:{flex:1,height:50,backgroundColor:"black",borderColor:e.divider,borderWidth:1,borderRadius:8,paddingHorizontal:10,fontSize:18,color:"white",textAlign:"center"},stepText:{fontSize:20,fontWeight:"bold",color:"white",marginBottom:15,textAlign:"center",paddingVertical:5,borderBottomWidth:1,borderBottomColor:e.divider},label:{fontSize:16,fontWeight:"600",color:"white",marginBottom:10}}),Q=({currentStep:e,totalSteps:t,stepNames:r,themeColors:a})=>{const n=X(a),i=Array.from({length:t},(e,t)=>t+1);return o.createElement(l.default,{style:{width:"100%",paddingHorizontal:0}},o.createElement(l.default,{style:n.progressContainer},i.map((i,s)=>{const d=i===e,c=i<e;let u=n.progressCircle;d?u=Object.assign({},u,n.progressCircleActive):c&&(u=Object.assign({},u,n.progressCircleDone));const m=s===t-1;return o.createElement(l.default,{key:i,style:n.progressStep},s>0&&o.createElement(l.default,{style:[n.progressConnectorBackground,{width:"100%",right:"50%"}]},o.createElement(l.default,{style:[{height:"100%"},n.progressConnectorActive,{width:c?"100%":d?"50%":"0%"}]})),o.createElement(l.default,{style:u},c?o.createElement(W.default,{size:18,color:"black"}):o.createElement(g.default,{style:{color:d?"#3ABFBC":a.textSecondary,fontWeight:"bold",fontSize:14}},i)),o.createElement(g.default,{style:[n.progressText,{color:c||d?"#3ABFBC":a.textSecondary}]},r[i-1]),!m&&o.createElement(l.default,{style:[n.progressConnectorBackground,{width:"100%",left:"50%"}]}))})))};function Z({isVisible:e,initialDate:t,onClose:r,onDateSelect:a}){const{colors:n}=k(),i=X(n);let s="",d="",c="";if(t instanceof Date&&!isNaN(t.getTime())){const e=q(t).split("/");s=e[0],d=e[1],c=e[2]}const[u,m]=(0,o.useState)(s),[f,p]=(0,o.useState)(d),[b,x]=(0,o.useState)(c),B=(0,o.useRef)(null),w=(0,o.useRef)(null);return o.createElement(C.default,{animationType:"fade",transparent:!0,visible:e,onRequestClose:r},o.createElement(h.default,{style:[i.modalOverlay,{justifyContent:"center",alignItems:"center"}],activeOpacity:1,onPressOut:r},o.createElement(l.default,{style:i.modalContent,onStartShouldSetResponder:()=>!0},o.createElement(g.default,{style:[i.wizardTitle,{color:"white",fontSize:20}]},"Seleccionar Fecha de Vencimiento"),o.createElement(l.default,{style:i.datePickerInputGroup},o.createElement(E.default,{style:i.datePickerInput,placeholder:"DD",placeholderTextColor:n.textSecondary,keyboardType:"numeric",maxLength:2,value:u,onChangeText:e=>{m(e.replace(/[^0-9]/g,"")),2===e.length&&B.current&&B.current.focus()}}),o.createElement(E.default,{ref:B,style:i.datePickerInput,placeholder:"MM",placeholderTextColor:n.textSecondary,keyboardType:"numeric",maxLength:2,value:f,onChangeText:e=>{p(e.replace(/[^0-9]/g,"")),2===e.length&&w.current&&w.current.focus()}}),o.createElement(E.default,{ref:w,style:i.datePickerInput,placeholder:"AAAA",placeholderTextColor:n.textSecondary,keyboardType:"numeric",maxLength:4,value:b,onChangeText:e=>x(e.replace(/[^0-9]/g,""))})),o.createElement(l.default,{style:{flexDirection:"row",justifyContent:"space-between",marginTop:10}},o.createElement(h.default,{style:[i.customButton,i.buttonDanger],onPress:r},o.createElement(g.default,{style:i.buttonText},"Cancelar")),o.createElement(h.default,{style:[i.customButton,i.buttonPrimary],onPress:()=>{const e=parseInt(u,10),t=parseInt(f,10),o=parseInt(b,10);if(isNaN(e)||isNaN(t)||isNaN(o)||e<1||t<1||t>12||o<2024||o>2100)return void y.default.alert("Error de Fecha","Por favor, ingrese valores v\xe1lidos para D\xeda (1-31), Mes (1-12) y A\xf1o (M\xedn. 2024).");const n=new Date(o,t-1,e);if(n.getFullYear()!==o||n.getMonth()!==t-1||n.getDate()!==e)return void y.default.alert("Error de Fecha","Fecha inv\xe1lida (Ej: Febrero tiene 28/29 d\xedas).");const l=new Date;l.setHours(0,0,0,0),n.setHours(0,0,0,0),n<=l?y.default.alert("Error de Fecha","La fecha de vencimiento debe ser una fecha futura."):(a(n),r())}},o.createElement(g.default,{style:i.buttonText},"Confirmar"))))))}function ee({students:e,onCancel:t,navigation:r}){const{colors:a}=k(),n=X(a),[i,s]=(0,o.useState)(1),[d,c]=(0,o.useState)(""),[u,m]=(0,o.useState)(""),[b,C]=(0,o.useState)(1),[x,w]=(0,o.useState)(null),[A,S]=(0,o.useState)(!1),[T,v]=(0,o.useState)(""),z=Object.assign({},n.label,{color:"white",fontSize:18,fontWeight:"bold",marginBottom:10}),I=a.isDark?a.textSecondary:"#6B7280",{getToken:R}=(0,o.useContext)(Fe),W=(0,o.useMemo)(()=>{if(!T)return e;const t=T.toLowerCase();return e.filter(e=>e.nombre.toLowerCase().includes(t)||e.email.toLowerCase().includes(t))},[e,T]),F=async e=>{y.default.alert("Confirmaci\xf3n de Asignaci\xf3n",`Al asignar esta nueva rutina, todas las asignaciones **activas** anteriores para **${e.nombre}** ser\xe1n inactivadas. \xbfContinuar?`,[{text:"Cancelar",style:"cancel"},{text:"Crear y Asignar",onPress:async()=>{await(async e=>{try{const t={Authorization:`Bearer ${await R()}`},r=await B.default.get(`${G}/professor/assignments/student/${e}`,{headers:t}),a=(Array.isArray(r.data)?r.data:[]).map(e=>B.default.patch(`${G}/assignments/${e.id}`,{is_active:!1},{headers:t}));await Promise.all(a),console.log(`Inactivadas ${a.length} asignaciones anteriores para el alumno ${e}.`)}catch(t){console.error("Error al inactivar asignaciones anteriores:",t.response?t.response.data:t.message)}})(e.id);const a=x?U(x):null;r.navigate("RoutineCreation",{studentId:e.id,studentName:e.nombre,routineMetadata:{nombre:d.trim(),descripcion:u.trim(),days:b,expirationDate:a}}),t()}}])},j=e=>{w(e)},L=e=>e?q(e):"Toca para Seleccionar Fecha",O=b>=1&&x;return o.createElement(p.default,{style:n.container},o.createElement(l.default,{style:n.headerSelection},o.createElement(g.default,{style:n.wizardTitle},"Crear Rutina Agrupada"),o.createElement(h.default,{style:[n.customButton,n.buttonDanger,{minWidth:80}],onPress:t},o.createElement(g.default,{style:n.buttonText},"Cancelar"))),o.createElement(Q,{currentStep:i,totalSteps:3,stepNames:["Nombre","Config","Asignaci\xf3n"],themeColors:a}),o.createElement(f.default,{contentContainerStyle:n.wizardContainer},(()=>{switch(i){case 1:return o.createElement(o.Fragment,null,o.createElement(g.default,{style:n.stepText},"Paso 1: Nombre y Descripci\xf3n del Grupo"),o.createElement(g.default,{style:z},"Nombre de la Agrupaci\xf3n:"),o.createElement(E.default,{style:n.wizardInput,placeholder:"Ej: Rutina Bloque A / Mes 1",placeholderTextColor:I,value:d,onChangeText:c,autoFocus:!0}),o.createElement(g.default,{style:z},"Descripci\xf3n del Grupo (Opcional):"),o.createElement(E.default,{style:[n.wizardInput,{height:80,textAlignVertical:"top"}],placeholder:"Ej: Fase de hipertrofia de 4 semanas.",placeholderTextColor:I,value:u,onChangeText:m,multiline:!0}),o.createElement(g.default,{style:n.warningTextCenter},"Este nombre agrupar\xe1 las rutinas (D\xeda 1, D\xeda 2, etc.)"));case 2:return o.createElement(o.Fragment,null,o.createElement(g.default,{style:n.stepText},"Paso 2: Configuraci\xf3n de la Agrupaci\xf3n"),o.createElement(g.default,{style:[z,{marginTop:20}]},"Cantidad de Rutinas (D\xedas):"),o.createElement(g.default,{style:n.warningTextCenter},"(M\xednimo 1, M\xe1ximo 5 rutinas)"),o.createElement(l.default,{style:n.routineCounter},o.createElement(h.default,{style:[n.counterButton,{backgroundColor:a.danger}],onPress:()=>C(e=>Math.max(1,e-1)),disabled:b<=1},o.createElement(D.default,{size:24,color:"black"})),o.createElement(g.default,{style:n.counterCountText},b),o.createElement(h.default,{style:[n.counterButton,{backgroundColor:"#3ABFBC"}],onPress:()=>C(e=>Math.min(5,e+1)),disabled:b>=5},o.createElement(P.default,{size:24,color:"black"}))),o.createElement(g.default,{style:[z,{marginTop:20}]},"Fecha de Vencimiento:"),o.createElement(h.default,{style:n.dateInputContainer,onPress:()=>S(!0)},o.createElement(g.default,{style:n.dateText},L(x)),o.createElement(N.default,{size:20,color:"#3ABFBC"})),o.createElement(Z,{isVisible:A,initialDate:x,onClose:()=>S(!1),onDateSelect:j}),o.createElement(g.default,{style:n.studentEmail},"Rutinas a crear: ",b," | Vence: ",x?L(x):"[Fecha Requerida]"));case 3:return o.createElement(o.Fragment,null,o.createElement(g.default,{style:n.stepText},"Paso 3: Selecciona el Alumno"),o.createElement(E.default,{style:n.searchInput,placeholder:"Buscar alumno por nombre o email...",placeholderTextColor:I,value:T,onChangeText:v}),o.createElement(f.default,{style:{maxHeight:400,marginBottom:20}},W.length>0?W.map(e=>o.createElement(h.default,{key:e.id.toString(),style:n.studentCard,onPress:()=>F(e)},o.createElement(l.default,null,o.createElement(g.default,{style:n.studentName},e.nombre),o.createElement(g.default,{style:n.studentEmail},e.email)),o.createElement(g.default,{style:Object.assign({},n.actionButtonText,{color:"#3ABFBC"})},"CREAR >> "))):o.createElement(g.default,{style:n.warningTextCenter},"No se encontraron alumnos.")),o.createElement(g.default,{style:n.studentEmail},"Agrupaci\xf3n: ",d.trim()," | Vence: ",x?L(x):"N/A"));default:return null}})(),o.createElement(l.default,{style:n.wizardActions},o.createElement(h.default,{style:[n.customButton,n.buttonSecondary,{opacity:1===i?.5:1}],onPress:()=>s(i-1),disabled:1===i},o.createElement(g.default,{style:n.buttonTextSecondary},"< Atr\xe1s")),(1===i||2===i)&&o.createElement(h.default,{style:[n.customButton,n.buttonPrimary,{opacity:(1===i?d.trim():O)?1:.5}],onPress:()=>{if(1===i){if(!d.trim())return void y.default.alert("Error","Debes ingresar un nombre para la agrupaci\xf3n.");s(2)}else if(2===i){if(b<1)return void y.default.alert("Error","Debes seleccionar al menos una rutina para crear.");if(!x)return void y.default.alert("Error","Debes seleccionar una fecha de vencimiento.");const e=new Date(x.setHours(0,0,0,0)),t=new Date((new Date).setHours(0,0,0,0));if(!e||isNaN(e.getTime()))return void y.default.alert("Error","Fecha de vencimiento inv\xe1lida.");if(e<=t)return void y.default.alert("Error","La fecha de vencimiento debe ser una fecha futura.");s(3)}},disabled:1===i?!d.trim():!O},o.createElement(g.default,{style:n.buttonText},"Siguiente >")))))}function te({navigation:e}){const{colors:t,isDark:r}=k(),a=X(t),[n,s]=(0,o.useState)([]),[d,c]=(0,o.useState)(!0),[u,m]=(0,o.useState)(null),[w,A]=(0,o.useState)(!1),[S,T]=(0,o.useState)(null),[v,z]=(0,o.useState)(!1),[I,D]=(0,o.useState)(""),{signOut:P,getToken:R,userProfile:W}=(0,o.useContext)(Fe),F=(0,o.useRef)(new x.default.Value(-280)).current,N=e=>{x.default.timing(F,{toValue:-280,duration:300,useNativeDriver:!0}).start(()=>{z(!1),e&&e()})},M=async()=>{c(!0),T(null);try{const e={Authorization:`Bearer ${await R()}`},t=await B.default.get(`${G}/users/students`,{headers:e});s(Array.isArray(t.data)?t.data:[])}catch(e){let t;console.error("Error cargando datos del profesor:",e.response?e.response.data:e.message),"Network Error"===e.message?t="Error de Red. Verifica la URL de Render o la conexi\xf3n del servidor.":!e.response||401!==e.response.status&&403!==e.response.status?t=e.response&&500===e.response.status?"Error interno del servidor (500) al cargar listas. Base de datos inconsistente.":"Error al cargar datos. Token inv\xe1lido o backend.":(t="Sesi\xf3n inv\xe1lida o expirada. Saliendo...",P()),T(t)}finally{c(!1)}};(0,o.useEffect)(()=>{const t=e.addListener("focus",M);return M(),t},[e,r]);const q=()=>{m(null),M()},U=(0,o.useMemo)(()=>{if(!I)return n;const e=I.toLowerCase();return n.filter(t=>t.nombre.toLowerCase().includes(e)||t.email.toLowerCase().includes(e))},[n,I]);return!S||d||u||w?d?o.createElement(p.default,{style:a.loadingContainer},o.createElement(i.default,{size:"large",color:"#3ABFBC"}),o.createElement(g.default,{style:{color:t.textSecondary,marginTop:10}},"Cargando panel de gesti\xf3n...")):w?o.createElement(ee,{navigation:e,students:n,onCancel:()=>A(!1)}):u?o.createElement(p.default,{style:a.container},o.createElement(K,{student:u,routines:[],onAssignmentComplete:q,onCancel:()=>m(null),navigation:e})):o.createElement(p.default,{style:a.container},o.createElement(l.default,{style:a.header},o.createElement(h.default,{onPress:()=>{z(!0),x.default.timing(F,{toValue:0,duration:300,useNativeDriver:!0}).start()},style:a.iconButton},o.createElement(j.default,{size:22,color:t.textPrimary})),o.createElement(g.default,{style:a.headerTitle},"Gestor de Alumnos"),o.createElement(h.default,{onPress:M,style:a.iconButton,disabled:d},o.createElement(L.default,{size:22,color:"#3ABFBC"}))),o.createElement(f.default,{style:{flex:1}},o.createElement(l.default,{style:a.actionSection},o.createElement(g.default,{style:a.subtitle},"\ud83d\udc4b Bienvenido/a Prof. ",W?.nombre?.split(" ")[0]||"Profesor/a"),o.createElement(g.default,{style:{fontSize:14,color:t.textSecondary}},"Utiliza el bot\xf3n flotante (Pesas) para crear una nueva rutina y asignarla.")),o.createElement(g.default,{style:a.listTitle},"Alumnos Registrados (",U.length,")"),o.createElement(E.default,{style:a.searchInput,placeholder:"Buscar alumno por nombre o email...",placeholderTextColor:t.textSecondary,value:I,onChangeText:D}),o.createElement(f.default,{contentContainerStyle:{paddingHorizontal:20,paddingBottom:80,paddingTop:10}},U.length>0?U.map(r=>o.createElement(l.default,{key:r.id.toString(),style:a.studentCard},o.createElement(l.default,null,o.createElement(g.default,{style:a.studentName},r.nombre),o.createElement(g.default,{style:a.studentEmail},r.email)),o.createElement(l.default,{style:a.studentCardActions},o.createElement(h.default,{style:[a.actionButton,{backgroundColor:t.warning}],onPress:()=>m(r)},o.createElement(g.default,{style:a.actionButtonText},"Rutina")),o.createElement(h.default,{style:[a.actionButton,{backgroundColor:"#3ABFBC"}],onPress:()=>{return t=r,void e.navigate("StudentDetails",{student:t});var t}},o.createElement(g.default,{style:a.actionButtonText},"Editar"))))):o.createElement(l.default,{style:{padding:20,alignItems:"center"}},o.createElement(g.default,{style:{color:t.textSecondary}},"No hay alumnos registrados que coincidan con la busqueda.")))),o.createElement(h.default,{style:a.fab,onPress:()=>A(!0)},o.createElement(O.default,{size:30,color:"black",style:a.fabIcon})),o.createElement(C.default,{animationType:"none",transparent:!0,visible:v,onRequestClose:()=>N()},o.createElement(h.default,{style:a.modalOverlay,activeOpacity:1,onPressOut:()=>N()},o.createElement(x.default.View,{style:[a.menuContainer,{transform:[{translateX:F}]}],onStartShouldSetResponder:()=>!0},o.createElement(p.default,{style:{flex:1}},o.createElement(f.default,{contentContainerStyle:{paddingBottom:70}},o.createElement(g.default,{style:a.menuTitle},"Men\xfa Profesor"),o.createElement(h.default,{style:a.menuItem,onPress:()=>{N(()=>y.default.alert("Mi Perfil","Esta secci\xf3n navegar\xe1 a tu pantalla de perfil (a\xfan no implementada)."))}},o.createElement($.default,{size:18,color:t.textPrimary}),o.createElement(g.default,{style:a.menuItemText},"Mi Perfil")),o.createElement(h.default,{style:a.menuItem,onPress:()=>{N(()=>e.navigate("ChangePassword"))}},o.createElement(V.default,{size:18,color:t.textPrimary}),o.createElement(g.default,{style:a.menuItemText},"Cambiar Contrase\xf1a")),o.createElement(h.default,{style:a.menuItem,onPress:()=>{N(()=>e.navigate("AddStudent"))}},o.createElement(H.default,{size:18,color:t.success}),o.createElement(g.default,{style:[a.menuItemText,{color:t.success}]},"Registrar Nuevo Alumno")),o.createElement(h.default,{style:[a.menuItem,{borderBottomWidth:0}],onPress:()=>{y.default.alert("Cerrar Sesi\xf3n","\xbfEst\xe1s seguro de que quieres cerrar sesi\xf3n?",[{text:"Cancelar",style:"cancel"},{text:"Cerrar",onPress:()=>{N(P)},style:"destructive"}])}},o.createElement(_.default,{size:18,color:t.danger}),o.createElement(g.default,{style:a.menuItemTextLogout},"Cerrar Sesi\xf3n")))),o.createElement(h.default,{style:a.menuItemClose,onPress:()=>N()},o.createElement(g.default,{style:a.menuItemTextClose},"Cerrar Men\xfa")))))):o.createElement(p.default,{style:a.container},o.createElement(l.default,{style:a.errorView},o.createElement(g.default,{style:a.errorTitle},"!Error de Conexi\xf3n!"),o.createElement(g.default,{style:a.errorDetail},S),o.createElement(l.default,{style:{marginTop:20}},o.createElement(b.default,{title:"Intentar de Nuevo",onPress:M,color:t.primary})),"Sesi\xf3n inv\xe1lida o expirada. Saliendo..."!==S&&o.createElement(l.default,{style:{marginTop:10}},o.createElement(b.default,{title:"Salir",onPress:P,color:t.danger}))))}var re=r(4767),ae=r(6933),oe=r(484);const ne=r(8704),le=r(1621);function ie({isVisible:e,onClose:t,API_URL:r,themeColors:a}){const[n,s]=(0,o.useState)(""),[d,c]=(0,o.useState)(""),[u,m]=(0,o.useState)(""),[b,y]=(0,o.useState)(""),[x,w]=(0,o.useState)(!1),[A,S]=(0,o.useState)(null),[k,T]=(0,o.useState)(!1),v=de(a);return o.createElement(C.default,{animationType:"slide",transparent:!1,visible:e,onRequestClose:t},o.createElement(p.default,{style:[v.modalContainer,{backgroundColor:"black"}]},o.createElement(f.default,{contentContainerStyle:v.modalContent},o.createElement(g.default,{style:[v.modalTitle,{color:"white"}]},"Registro de Alumno"),A&&o.createElement(g.default,{style:[v.errorText,{color:"white",backgroundColor:"#B91C1CAB"}]},A),k&&o.createElement(g.default,{style:[v.successText,{color:"#3ABFBC"}]},"\xa1Registro exitoso! Ya puedes ingresar con tu DNI y contrase\xf1a."),o.createElement(E.default,{style:[v.input,{backgroundColor:"#1C1C1E",color:"white",borderColor:"#1C1C1E"}],placeholder:"Nombre completo",placeholderTextColor:"#A9A9A9",value:n,onChangeText:s}),o.createElement(E.default,{style:[v.input,{backgroundColor:"#1C1C1E",color:"white",borderColor:"#1C1C1E"}],placeholder:"Email",placeholderTextColor:"#A9A9A9",value:d,onChangeText:c,keyboardType:"email-address",autoCapitalize:"none"}),o.createElement(E.default,{style:[v.input,{backgroundColor:"#1C1C1E",color:"white",borderColor:"#1C1C1E"}],placeholder:"Numero de Documento (DNI)",placeholderTextColor:"#A9A9A9",value:u,onChangeText:m,keyboardType:"numeric"}),o.createElement(E.default,{style:[v.input,{backgroundColor:"#1C1C1E",color:"white",borderColor:"#1C1C1E"}],placeholder:"Contrase\xf1a",placeholderTextColor:"#A9A9A9",value:b,onChangeText:y,secureTextEntry:!0}),o.createElement(h.default,{style:[v.customButton,v.buttonSuccess,{opacity:x?.6:1,marginTop:30}],onPress:async()=>{if(n&&d&&u&&b){w(!0),S(null),T(!1);try{await B.default.post(`${r}/register/student`,{nombre:n,email:d,dni:u,password:b,rol:"Alumno"}),T(!0),s(""),c(""),m(""),y("")}catch(e){console.error("Error en el registro:",e.response?e.response.data:e.message);const t=e.response?.data?.detail;let a=t&&"string"===typeof t?t:"Fallo desconocido en el servidor.";a.includes("DNI ya esta registrado")?a="El DNI proporcionado ya se encuentra registrado.":a.includes("El email ya esta registrado")?a="El Email proporcionado ya se encuentra registrado.":"Network Error"===e.message&&(a=`Error de Conexion. Asegurate de que el servidor de FastAPI y Ngrok estan activos y que la URL (${r}) es la correcta.`),S(`Error en el registro: ${a}`)}finally{w(!1)}}else S("Todos los campos son obligatorios.")},disabled:x},x?o.createElement(i.default,{size:"small",color:"black"}):o.createElement(g.default,{style:v.buttonText},"REGISTRARSE")),o.createElement(l.default,{style:{marginTop:20}},o.createElement(h.default,{style:[v.customButton,v.buttonSecondary,{marginTop:0}],onPress:t},o.createElement(g.default,{style:v.buttonTextSecondary},"VOLVER A INGRESAR"))))))}function se({signIn:e,API_URL:t}){const{colors:r,isDark:a,toggleTheme:n}=k(),[s,d]=(0,o.useState)(""),[c,u]=(0,o.useState)(""),[m,b]=(0,o.useState)(!1),[y,C]=(0,o.useState)(null),x=de(r),[w,A]=(0,o.useState)(!1);return o.createElement(ae.default,{source:le||null,style:x.backgroundImagePeakfit,imageStyle:x.backgroundImageStylePeakfit},o.createElement(p.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.6)"}},o.createElement(re.default,{style:{flex:1},behavior:"height"},o.createElement(ie,{isVisible:w,onClose:()=>A(!1),API_URL:t,themeColors:r}),o.createElement(f.default,{contentContainerStyle:x.contentLogin},o.createElement(l.default,{style:x.headerPeakfit},ne&&o.createElement(oe.default,{source:ne,style:x.logoImagePeakfit}),o.createElement(g.default,{style:x.sloganText},"Es hora de llegar muy lejos")),o.createElement(g.default,{style:x.titlePeakfit},"Iniciar Sesi\xf3n"),y&&o.createElement(g.default,{style:x.errorText},y),o.createElement(g.default,{style:x.inputLabelPeakfit},"Email o DNI"),o.createElement(E.default,{style:[x.inputPeakfit,{backgroundColor:"#1C1C1E",color:"white"}],placeholder:"Email o DNI",placeholderTextColor:"#A9A9A9",value:s,onChangeText:d,keyboardType:"email-address",autoCapitalize:"none"}),o.createElement(g.default,{style:x.inputLabelPeakfit},"Contrase\xf1a"),o.createElement(l.default,{style:x.passwordContainerPeakfit},o.createElement(E.default,{style:[x.inputPeakfit,x.passwordInputPeakfit,{backgroundColor:"#1C1C1E",color:"white"}],placeholder:"Contrase\xf1a",placeholderTextColor:"#A9A9A9",value:c,onChangeText:u,secureTextEntry:!0}),o.createElement(g.default,{style:x.passwordIconPeakfit},"\ud83d\udc41\ufe0f")),m?o.createElement(i.default,{size:"large",color:"#3ABFBC",style:{marginTop:25}}):o.createElement(o.Fragment,null,o.createElement(h.default,{style:[x.customButtonPeakfit,x.buttonPrimaryPeakfit,{marginTop:30}],onPress:async()=>{if(s&&c){b(!0),C(null);try{const r=(await B.default.post(`${t}/login`,{dni:s,password:c})).data.access_token;await e(r)}catch(r){console.error("Error de Login:",r.response?r.response.data:r.message);let e="DNI o contrase\xf1a incorrectos.";"Network Error"===r.message?e=`Error de Conexion. Asegurate de que el servidor de FastAPI y Ngrok estan activos y que la URL (${t}) es la correcta.`:r.response&&401!==r.response.status&&(e=`Error del Servidor (${r.response.status}). Intenta mas tarde.`),C(e)}finally{b(!1)}}else C("Por favor, ingresa DNI y contrase\xf1a.")}},o.createElement(g.default,{style:x.buttonTextPeakfit},"INICIAR SESI\xd3N"))),o.createElement(l.default,{style:x.signUpContainerPeakfit},o.createElement(g.default,{style:x.signUpTextPeakfit},"\xbfNo tienes una cuenta? "),o.createElement(h.default,{onPress:()=>A(!0)},o.createElement(g.default,{style:x.signUpLinkPeakfit},"Registrarse")))))))}const de=e=>n.default.create({backgroundImagePeakfit:{flex:1},backgroundImageStylePeakfit:{opacity:.4},contentLogin:{paddingHorizontal:25,paddingVertical:50,flexGrow:1,justifyContent:"center"},headerPeakfit:{alignItems:"center",marginBottom:20},logoImagePeakfit:{width:200,height:200,resizeMode:"contain"},sloganText:{fontSize:14,color:"#A9A9A9",fontStyle:"italic",marginTop:-20,marginBottom:20},titlePeakfit:{fontSize:30,fontWeight:"bold",color:"white",marginBottom:15},inputLabelPeakfit:{fontSize:14,color:"#A9A9A9",marginBottom:8},inputPeakfit:{height:50,backgroundColor:"#1C1C1E",color:"white",borderRadius:10,paddingHorizontal:15,marginBottom:20,fontSize:16,borderWidth:0},passwordContainerPeakfit:{flexDirection:"row",alignItems:"center",marginBottom:0},passwordInputPeakfit:{flex:1,marginBottom:0},passwordIconPeakfit:{position:"absolute",right:15,color:"#A9A9A9",fontSize:18},customButtonPeakfit:{paddingVertical:15,borderRadius:10,alignItems:"center",justifyContent:"center",shadowColor:"#3ABFBC",shadowOffset:{width:0,height:4},shadowOpacity:.3,shadowRadius:5,elevation:8},buttonPrimaryPeakfit:{backgroundColor:"#3ABFBC"},buttonTextPeakfit:{fontSize:18,fontWeight:"bold",color:"black"},signUpContainerPeakfit:{flexDirection:"row",justifyContent:"center",marginTop:40},signUpTextPeakfit:{color:"#A9A9A9",fontSize:14},signUpLinkPeakfit:{color:"#3ABFBC",fontSize:14,fontWeight:"bold"},errorText:{marginBottom:15,textAlign:"center",padding:10,borderRadius:8,fontWeight:"600",color:"white",backgroundColor:"#B91C1CAB"},modalContainer:{flex:1,paddingTop:40,backgroundColor:"black"},modalContent:{padding:30,flexGrow:1,justifyContent:"center"},modalTitle:{fontSize:28,fontWeight:"bold",textAlign:"center",marginBottom:30,color:"white"},input:{height:50,backgroundColor:"#1C1C1E",color:"white",borderRadius:10,paddingHorizontal:15,marginBottom:20,fontSize:16,borderWidth:0},customButton:{paddingVertical:14,paddingHorizontal:20,borderRadius:10,alignItems:"center",justifyContent:"center",minWidth:100,marginTop:15},buttonSuccess:{backgroundColor:"#3ABFBC"},buttonSecondary:{backgroundColor:"#1C1C1E",borderColor:"#A9A9A9",borderWidth:1},buttonText:{fontSize:16,fontWeight:"bold",color:"black"},buttonTextSecondary:{fontSize:16,fontWeight:"bold",color:"white"},successText:{marginBottom:15,textAlign:"center",fontWeight:"bold",color:"#3ABFBC"}});var ce=r(6195),ue=r(2603),me=r(7471);const ge="https://gym-app-backend-e9bn.onrender.com",fe=({index:e,exercise:t,updateExercise:r,removeExercise:a,toggleSelector:i,themeColors:s})=>{const d=(c=s,n.default.create({card:{backgroundColor:"#1C1C1E",borderRadius:10,padding:15,marginBottom:15,borderLeftWidth:5,borderLeftColor:"#3ABFBC",elevation:4,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.8,shadowRadius:5},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},title:{fontSize:16,fontWeight:"700",color:"white",opacity:1},deleteButton:{padding:5},selectButton:{backgroundColor:"#1C1C1E",borderRadius:8,paddingHorizontal:15,paddingVertical:12,marginBottom:15,flexDirection:"row",alignItems:"center",justifyContent:"flex-start",borderWidth:1,borderColor:c.divider},selectButtonText:{color:"white",fontSize:17,fontWeight:"600",marginLeft:10,flexShrink:1},row:{flexDirection:"row",justifyContent:"space-between",marginTop:5},compactLabel:{fontSize:12,color:"#A9A9A9",marginBottom:3,fontWeight:"bold",textAlign:"center",textTransform:"uppercase"},inputGroup:{width:"31%",alignItems:"center"},input:{height:40,backgroundColor:"black",borderColor:c.divider,borderWidth:1,borderRadius:8,paddingHorizontal:5,fontSize:14,color:"white",textAlign:"center",width:"100%"}}));var c;const u=(t,a)=>{r(e,t,a)},m="#A9A9A9",f=t.exercise_id?"#3ABFBC":s.danger,p=(t.exercise_id,"#1C1C1E");return o.createElement(l.default,{style:d.card},o.createElement(l.default,{style:d.header},o.createElement(g.default,{style:d.title},"Ejercicio #",e+1),o.createElement(h.default,{onPress:()=>a(e),style:d.deleteButton},o.createElement(F.default,{size:20,color:s.danger}))),o.createElement(h.default,{style:[d.selectButton,{backgroundColor:p}],onPress:()=>i(e)},o.createElement(ce.default,{size:20,color:f}),o.createElement(g.default,{style:[d.selectButtonText,!t.exercise_id&&{color:s.danger}],numberOfLines:1,ellipsizeMode:"tail"},t.name||"Toca para Seleccionar Ejercicio")),o.createElement(l.default,{style:d.row},o.createElement(l.default,{style:d.inputGroup},o.createElement(g.default,{style:d.compactLabel},"Series"),o.createElement(E.default,{style:d.input,placeholder:"3",placeholderTextColor:m,keyboardType:"numeric",value:t.series,onChangeText:e=>u("series",e)})),o.createElement(l.default,{style:d.inputGroup},o.createElement(g.default,{style:d.compactLabel},"Repeticiones"),o.createElement(E.default,{style:d.input,placeholder:"10-12",placeholderTextColor:m,keyboardType:"default",value:t.repetitions,onChangeText:e=>u("repetitions",e)})),o.createElement(l.default,{style:d.inputGroup},o.createElement(g.default,{style:d.compactLabel},"Peso"),o.createElement(E.default,{style:d.input,placeholder:"20 kg",placeholderTextColor:m,keyboardType:"default",value:t.peso,onChangeText:e=>u("peso",e)}))))};function pe({navigation:e}){const{colors:t}=k(),r=(a=t,n.default.create({container:{flex:1,backgroundColor:"black"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"black"},content:{padding:20,paddingBottom:100},subHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:20,paddingVertical:10,backgroundColor:"black",borderBottomWidth:1,borderBottomColor:a.divider},actionButton:{flexDirection:"row",alignItems:"center",paddingVertical:10,paddingHorizontal:15,borderRadius:10,justifyContent:"center",width:"48%"},selectorActionButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:"#3ABFBC",borderRadius:10,paddingVertical:10,marginHorizontal:20,marginTop:10,marginBottom:15},actionButtonText:{color:"black",fontWeight:"bold",marginLeft:8,fontSize:14},cancelButton:{backgroundColor:a.danger},label:{fontSize:16,fontWeight:"600",color:"white",marginBottom:5,marginTop:15},input:{height:50,backgroundColor:"#1C1C1E",borderColor:a.divider,borderWidth:1,borderRadius:10,paddingHorizontal:15,fontSize:16,marginBottom:15,color:"white"},textArea:{height:80,textAlignVertical:"top",paddingTop:10},sectionTitle:{fontSize:20,fontWeight:"bold",color:"white",marginTop:25,marginBottom:15},floatingButton:{position:"absolute",bottom:20,right:20,backgroundColor:"#3ABFBC",padding:15,borderRadius:30,flexDirection:"row",alignItems:"center",elevation:8,shadowColor:"#3ABFBC",shadowOffset:{width:0,height:4},shadowOpacity:.8,shadowRadius:5},floatingButtonText:{color:"black",fontWeight:"bold",marginLeft:8,fontSize:16},selectorContainer:{flex:1,backgroundColor:"black",paddingTop:0},selectorHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:15,borderBottomWidth:1,borderBottomColor:a.divider,backgroundColor:"black"},selectorTitle:{fontSize:20,fontWeight:"bold",color:"white",flex:1,textAlign:"center"},selectorSearchInput:{height:45,backgroundColor:"#1C1C1E",borderColor:a.divider,borderWidth:1,borderRadius:10,paddingHorizontal:15,marginHorizontal:20,marginTop:10,marginBottom:15,fontSize:16,color:"white"},selectorList:{paddingHorizontal:0,paddingVertical:10},selectorItem:{paddingVertical:15,paddingHorizontal:20,borderBottomWidth:1,borderBottomColor:a.divider,flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"black"},selectorItemName:{fontSize:17,fontWeight:"600",color:"white",flexShrink:1},selectorItemGroup:{fontSize:14,color:"#A9A9A9",marginLeft:10},closeSelectorButton:{padding:5},screenHeader:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:20,paddingVertical:10,backgroundColor:"black",borderBottomWidth:1,borderBottomColor:a.divider},screenTitle:{fontSize:18,fontWeight:"bold",color:"white",textAlign:"center"},addExerciseButtonText:{color:"black",fontWeight:"bold",marginLeft:8,fontSize:16}}));var a;const s=(0,d.useRoute)(),{studentId:c,studentName:u,routineId:m,routineMetadata:b}=s.params||{},C=!!m,x=C?1:b?.days||1,w=C?"":b?.nombre||"Nueva Rutina",[A,S]=(0,o.useState)(1),[T,v]=(0,o.useState)(()=>C?[]:Array.from({length:x},(e,t)=>({day:t+1,name:`${w} - D\xeda ${t+1}`,description:"",exercises:[]}))),z=T[A-1]||{exercises:[],name:"",description:""},[I,D]=(0,o.useState)([]),[P,W]=(0,o.useState)(!1),[F,N]=(0,o.useState)(null),[j,L]=(0,o.useState)(""),[O,$]=(0,o.useState)(!0),[V,H]=(0,o.useState)(!1),[_,G]=(0,o.useState)(null),{getToken:M}=(0,o.useContext)(Fe),q=(e,t)=>{v(r=>{const a=[...r];return a[A-1]&&(a[A-1][e]=t),a})},U=(e,t,r)=>{v(a=>{const o=[...a],n=[...o[A-1]?.exercises||[]];return n[e]&&(n[e]=Object.assign({},n[e],{[t]:r})),o[A-1]&&(o[A-1].exercises=n),o})},J=(0,o.useCallback)(async()=>{$(!0),G(null);try{const e={Authorization:`Bearer ${await M()}`},t=await B.default.get(`${ge}/exercises/`,{headers:e});if(D(t.data),C&&m&&0===T.length){const t=(await B.default.get(`${ge}/routines/${m}`,{headers:e})).data,r=t.exercise_links.sort((e,t)=>e.order-t.order).map(e=>({exercise_id:e.exercise_id,name:e.exercise?.nombre||"Ejercicio Desconocido",series:String(e.sets||""),repetitions:String(e.repetitions||""),peso:String(e.peso||"")}));v([{day:1,name:t.nombre,description:t.descripcion||"",exercises:r}])}}catch(e){console.error("Error loading data:",e.response?e.response.data:e.message),G("Error de conexi\xf3n al cargar datos. "+(C?"Rutina no encontrada.":""))}finally{$(!1)}},[C,m,M,T.length]);(0,o.useEffect)(()=>{J(),e.setOptions({headerLeft:()=>null,title:C?`Editar: ${s.params?.routineMetadata?.nombre||"Rutina"}`:`Creaci\xf3n: ${w}`})},[m,J]),(0,o.useEffect)(()=>e.addListener("focus",()=>{J()}),[e,J]);const Y=()=>{W(!1),e.navigate("ExercisesAdd")},K=e=>{y.default.alert("Confirmar Eliminaci\xf3n",`\xbfEst\xe1s seguro de que quieres eliminar el ejercicio #${e+1}?`,[{text:"Cancelar",style:"cancel"},{text:"Eliminar",style:"destructive",onPress:()=>{const t=z.exercises.filter((t,r)=>r!==e);q("exercises",t)}}])},X=e=>{N(e),W(!0),L("")},Q=()=>{if(!z.name.trim())return y.default.alert("Error","El nombre de la rutina no puede estar vac\xedo."),!1;if(0===z.exercises.length)return y.default.alert("Error",`La rutina "${z.name}" debe tener al menos un ejercicio.`),!1;return!z.exercises.find(e=>{if(!e.exercise_id)return!0;const t=e.series?e.series.trim():"",r=parseInt(t);if(isNaN(r)||r<=0)return!0;return 0===(e.repetitions?e.repetitions.trim():"").length})||(y.default.alert("Error de Validaci\xf3n",`En "${z.name}": Todos los ejercicios deben estar seleccionados y tener Series (entero positivo) y Repeticiones no vac\xedas.`),!1)},Z=async()=>{if(V)return;H(!0);const t=b?.expirationDate,r={nombre:w,descripcion:b?.descripcion||null,fecha_vencimiento:t,student_id:c,days:x,routines:T.map((e,t)=>({nombre:e.name,descripcion:e.description.trim()||"",exercises:e.exercises.map((e,t)=>({exercise_id:e.exercise_id,sets:parseInt(e.series.trim()),repetitions:e.repetitions.trim(),peso:e.peso.trim()||"N/A",order:t+1}))}))};try{const t={Authorization:`Bearer ${await M()}`};await B.default.post(`${ge}/routines-group/create-transactional`,r,{headers:t}),y.default.alert("\xc9xito Total!",`Se cre\xf3 la agrupaci\xf3n "${w}" con ${x} rutinas y fue asignada a ${u}.`),e.goBack()}catch(a){console.error("Error saving transaction (API):",a.response?a.response.data:a.message);let e="Fallo desconocido al guardar la transacci\xf3n.";a.response&&a.response.data&&a.response.data.detail&&(Array.isArray(a.response.data.detail)||"string"===typeof a.response.data.detail)&&(e=`Error de FastAPI: ${JSON.stringify(a.response.data.detail)}`),y.default.alert("Error de Guardado",e)}finally{H(!1)}},ee=C?async()=>{if(Q()){H(!0);try{const t={Authorization:`Bearer ${await M()}`},r=z,a={nombre:r.name.trim(),descripcion:r.description.trim()||"",exercises:r.exercises.map((e,t)=>({exercise_id:e.exercise_id,sets:parseInt(e.series.trim()),repetitions:e.repetitions.trim(),peso:e.peso.trim()||"N/A",order:t+1}))};await B.default.patch(`${ge}/routines/${m}`,a,{headers:t}),y.default.alert("\xc9xito de Edici\xf3n",`Rutina "${r.name.trim()}" actualizada exitosamente.`),e.goBack()}catch(t){console.error("Error saving routine (API):",t.message,JSON.stringify(t.response?t.response.data:t.message));let e="Fallo desconocido al guardar la rutina.";t.response&&t.response.data&&t.response.data.detail?(Array.isArray(t.response.data.detail)||"string"===typeof t.response.data.detail)&&(e=`Error de FastAPI: ${JSON.stringify(t.response.data.detail)}`):"Network Error"===t.message&&(e="Error de red: No se pudo conectar al servidor API."),y.default.alert("Error de Edici\xf3n",e)}finally{H(!1)}}}:async()=>{Q()&&(A<x?(S(A+1),y.default.alert("Rutina Guardada Temporalmente",`\xa1Rutina "${z.name}" completada! Editando el D\xeda ${A+1}.`,[{text:"OK"}])):await Z())},te=I.filter(e=>e.nombre.toLowerCase().includes(j.toLowerCase())||e.grupo_muscular&&e.grupo_muscular.toLowerCase().includes(j.toLowerCase()));if(O||0===T.length&&!C&&!_)return o.createElement(l.default,{style:r.loadingContainer},o.createElement(i.default,{size:"large",color:"#3ABFBC"}),o.createElement(g.default,{style:{marginTop:10,color:t.textSecondary}},"Cargando datos..."));const ae="#A9A9A9",oe=C?"Guardar Cambios":A<x?`Siguiente (D\xeda ${A+1})`:"Guardar Todo",ne=C?t.warning:"#3ABFBC";return P?o.createElement(p.default,{style:r.selectorContainer},o.createElement(l.default,{style:r.selectorHeader},o.createElement(h.default,{onPress:()=>W(!1),style:r.closeSelectorButton},o.createElement(R.default,{size:28,color:t.danger})),o.createElement(g.default,{style:r.selectorTitle},"Seleccionar Ejercicio"),o.createElement(l.default,{style:{width:28}})),o.createElement(E.default,{style:r.selectorSearchInput,placeholder:"Buscar (Nombre o Grupo Muscular)",placeholderTextColor:ae,value:j,onChangeText:L}),o.createElement(h.default,{onPress:Y,style:[r.selectorActionButton,{backgroundColor:"#3ABFBC"}],disabled:V},o.createElement(ue.default,{size:18,color:"black"}),o.createElement(g.default,{style:r.addExerciseButtonText},"Agregar Nuevo Ejercicio al Cat\xe1logo")),o.createElement(f.default,{contentContainerStyle:r.selectorList},te.length>0?te.map(e=>o.createElement(h.default,{key:e.id.toString(),style:r.selectorItem,onPress:()=>((e,t)=>{null!==F&&(z.exercises.some((t,r)=>r!==F&&t.exercise_id===e)&&y.default.alert("Advertencia","Este ejercicio ya est\xe1 en la rutina. Puedes editar sus series/repeticiones."),U(F,"exercise_id",e),U(F,"name",t));W(!1),L(""),N(null)})(e.id,e.nombre)},o.createElement(g.default,{style:r.selectorItemName},e.nombre),o.createElement(g.default,{style:r.selectorItemGroup},"Grupo: ",e.grupo_muscular))):o.createElement(g.default,{style:{textAlign:"center",color:t.textSecondary,marginTop:20}},"No se encontraron ejercicios con ese filtro."))):o.createElement(p.default,{style:r.container},o.createElement(l.default,{style:r.screenHeader},o.createElement(g.default,{style:r.screenTitle},C?`Editar Rutina: ${z.name}`:`Creaci\xf3n: ${z.name}`)),o.createElement(l.default,{style:r.subHeader},o.createElement(h.default,{onPress:()=>e.goBack(),style:[r.actionButton,r.cancelButton],disabled:V},o.createElement(R.default,{size:18,color:"black"}),o.createElement(g.default,{style:r.actionButtonText},"Cancelar")),o.createElement(h.default,{onPress:ee,style:[r.actionButton,{backgroundColor:ne}],disabled:V||!z.name.trim()||0===z.exercises.length},V?o.createElement(i.default,{size:"small",color:"black"}):o.createElement(me.default,{size:18,color:"black"}),o.createElement(g.default,{style:r.actionButtonText},V?"Guardando...":oe))),o.createElement(re.default,{style:{flex:1},behavior:"height",keyboardVerticalOffset:20},o.createElement(f.default,{contentContainerStyle:r.content},o.createElement(g.default,{style:r.label},"Nombre de la Rutina (D\xeda ",A,"):"),o.createElement(E.default,{style:r.input,placeholder:"Ej: Rutina Hipertrofia D\xeda A",placeholderTextColor:ae,value:z.name,onChangeText:e=>q("name",e),editable:!V}),o.createElement(g.default,{style:r.label},"Descripci\xf3n (Opcional):"),o.createElement(E.default,{style:[r.input,r.textArea],placeholder:"Ej: Fase de volumen 4 semanas",placeholderTextColor:ae,value:z.description,onChangeText:e=>q("description",e),multiline:!0,editable:!V}),o.createElement(g.default,{style:r.sectionTitle},"Ejercicios (",z.exercises.length,"):"),o.createElement(l.default,null,z.exercises.map((e,r)=>o.createElement(fe,{key:r.toString(),index:r,exercise:e,updateExercise:U,removeExercise:K,toggleSelector:X,themeColors:t}))))),o.createElement(h.default,{onPress:()=>{const e=[...z.exercises,{exercise_id:null,name:"",series:"",repetitions:"",peso:""}];q("exercises",e)},style:r.floatingButton,disabled:V||_||0===I.length},o.createElement(ue.default,{size:24,color:"black"}),o.createElement(g.default,{style:r.floatingButtonText},"A\xf1adir Ejercicio")))}function be({navigation:e}){const{colors:t,isDark:r}=k(),a=n.default.create({safeArea:{flex:1,backgroundColor:"black"},container:{padding:20,alignItems:"center"},title:{fontSize:28,fontWeight:"bold",color:"white",marginBottom:30,marginTop:20},input:{width:"100%",height:50,backgroundColor:"#1C1C1E",borderColor:"transparent",borderWidth:1,borderRadius:10,paddingHorizontal:15,marginBottom:15,fontSize:16,color:"white"},button:{width:"100%",backgroundColor:"#3ABFBC",padding:15,borderRadius:10,alignItems:"center",marginTop:20,shadowColor:"#3ABFBC",shadowOffset:{width:0,height:4},shadowOpacity:.6,shadowRadius:5,elevation:6},buttonText:{color:"black",fontSize:18,fontWeight:"bold"}}),[l,s]=(0,o.useState)(""),[d,c]=(0,o.useState)(""),[u,m]=(0,o.useState)(""),[b,C]=(0,o.useState)(!1),{getToken:x,signOut:w}=(0,o.useContext)(Fe);return o.createElement(p.default,{style:a.safeArea},o.createElement(f.default,{contentContainerStyle:a.container},o.createElement(g.default,{style:a.title},"Cambiar Contrase\xf1a"),o.createElement(E.default,{style:a.input,placeholder:"Contrase\xf1a Antigua",placeholderTextColor:"#A9A9A9",secureTextEntry:!0,value:l,onChangeText:s,editable:!b}),o.createElement(E.default,{style:a.input,placeholder:"Nueva Contrase\xf1a (m\xednimo 6 caracteres)",placeholderTextColor:"#A9A9A9",secureTextEntry:!0,value:d,onChangeText:c,editable:!b}),o.createElement(E.default,{style:a.input,placeholder:"Confirmar Nueva Contrase\xf1a",placeholderTextColor:"#A9A9A9",secureTextEntry:!0,value:u,onChangeText:m,editable:!b}),b?o.createElement(i.default,{size:"large",color:"#3ABFBC",style:{marginTop:20}}):o.createElement(h.default,{style:a.button,onPress:async()=>{if(d===u)if(d.length<6)y.default.alert("Error","La nueva contrase\xf1a debe tener al menos 6 caracteres.");else{C(!0);try{const e=await x();if(!e)return void w();await B.default.post("https://gym-app-backend-e9bn.onrender.com/users/change-password",{old_password:l,new_password:d},{headers:{Authorization:`Bearer ${e}`}});y.default.alert("\xc9xito","Tu contrase\xf1a ha sido actualizada. Por favor, vuelve a iniciar sesi\xf3n.",[{text:"OK",onPress:()=>w()}])}catch(e){console.error("Error al cambiar contrase\xf1a:",e.response?e.response.data:e.message);const t=e.response?.data?.detail||"Fallo desconocido al cambiar la contrase\xf1a.";y.default.alert("Error",t)}finally{C(!1)}}else y.default.alert("Error","La nueva contrase\xf1a y la confirmaci\xf3n no coinciden.")}},o.createElement(g.default,{style:a.buttonText},"Actualizar Contrase\xf1a")),o.createElement(h.default,{onPress:()=>e.goBack(),style:{marginTop:30,padding:10}},o.createElement(g.default,{style:{color:"#3ABFBC",fontSize:16,fontWeight:"bold"}},"Cancelar y Volver"))))}var he=r(5395);function ye({navigation:e}){const t=(0,d.useRoute)(),{student:r}=t.params,{colors:a}=k(),{getToken:s}=(0,o.useContext)(Fe),[c,u]=(0,o.useState)(r.nombre||""),[m,b]=(0,o.useState)(r.email||""),[C,x]=(0,o.useState)(r.dni||""),[w,A]=(0,o.useState)(!1),S=c!==r.nombre||m!==r.email||C!==r.dni,T=async()=>{if(S)if(c.trim()&&m.trim()&&C.trim()){A(!0);try{const t={Authorization:`Bearer ${await s()}`},a={nombre:c.trim(),email:m.trim(),dni:C.trim()};await B.default.patch(`https://gym-app-backend-e9bn.onrender.com/users/student/${r.id}`,a,{headers:t}),y.default.alert("\xc9xito",`Los datos de ${c} se actualizaron correctamente.`),e.navigate("ProfessorPanel",{reload:!0})}catch(t){console.error("Error al guardar datos del alumno:",t.response?t.response.data:t.message);let e="Fallo al actualizar. Verifica la conexi\xf3n o el DNI/Email ya est\xe1n en uso.";t.response&&t.response.data&&t.response.data.detail&&(e=t.response.data.detail),y.default.alert("Error",e)}finally{A(!1)}}else y.default.alert("Error","Todos los campos deben estar completos.");else y.default.alert("Atencion","No hay cambios para guardar.")},v=n.default.create({container:{flex:1,backgroundColor:"black"},header:{flexDirection:"row",alignItems:"center",padding:15,paddingTop:15,backgroundColor:"black",borderBottomWidth:1,borderBottomColor:"#1C1C1E"},scrollContent:{padding:20},title:{fontSize:26,fontWeight:"bold",color:"white",marginBottom:20,borderBottomWidth:2,borderBottomColor:"#3ABFBC",paddingBottom:5},detailCard:{backgroundColor:"#1C1C1E",padding:15,borderRadius:10,marginBottom:15,borderLeftWidth:5,borderLeftColor:"#3ABFBC"},detailLabel:{fontSize:14,color:"#A9A9A9",fontWeight:"600",marginTop:15,marginBottom:5},inputField:{fontSize:18,color:"white",fontWeight:"bold",paddingVertical:10,borderBottomWidth:1,borderBottomColor:"#A9A9A9",backgroundColor:"black",borderRadius:6,paddingHorizontal:10,marginBottom:10},detailValueStatic:{fontSize:18,color:"white",fontWeight:"bold"},buttonContainer:{marginTop:30,gap:10},customButton:{paddingVertical:12,paddingHorizontal:20,borderRadius:10,alignItems:"center",justifyContent:"center",minWidth:"100%"},buttonText:{fontSize:16,fontWeight:"bold",color:"black"},buttonSuccess:{backgroundColor:"#3ABFBC"},buttonSecondary:{backgroundColor:"#1C1C1E"},buttonTextSecondary:{color:"white"}});return o.createElement(p.default,{style:v.container},o.createElement(l.default,{style:v.header},o.createElement(h.default,{onPress:()=>e.goBack()},o.createElement(he.default,{size:24,color:"white"})),o.createElement(g.default,{style:[v.title,{flex:1,textAlign:"center",borderBottomWidth:0,marginHorizontal:10,marginBottom:0}]},"Editar Alumno"),o.createElement(l.default,{style:{width:24}})),o.createElement(f.default,{contentContainerStyle:v.scrollContent},o.createElement(g.default,{style:v.title},"Detalles de: ",r.nombre),o.createElement(l.default,{style:v.detailCard},o.createElement(g.default,{style:v.detailLabel},"Nombre Completo:"),o.createElement(E.default,{style:v.inputField,value:c,onChangeText:u,placeholder:"Nombre",placeholderTextColor:"#A9A9A9",editable:!w}),o.createElement(g.default,{style:v.detailLabel},"Email:"),o.createElement(E.default,{style:v.inputField,value:m,onChangeText:b,placeholder:"Email",placeholderTextColor:"#A9A9A9",keyboardType:"email-address",editable:!w}),o.createElement(g.default,{style:v.detailLabel},"DNI:"),o.createElement(E.default,{style:v.inputField,value:C,onChangeText:x,placeholder:"DNI",placeholderTextColor:"#A9A9A9",keyboardType:"numeric",editable:!w}),o.createElement(g.default,{style:v.detailLabel},"ID Interno (Estatico):"),o.createElement(g.default,{style:v.detailValueStatic},r.id)),o.createElement(l.default,{style:v.buttonContainer},w?o.createElement(i.default,{size:"large",color:"#3ABFBC"}):o.createElement(o.Fragment,null,o.createElement(h.default,{style:[v.customButton,v.buttonSuccess,{opacity:!S||w?.5:1}],onPress:T,disabled:!S||w},o.createElement(g.default,{style:v.buttonText},w?"Guardando...":S?"GUARDAR CAMBIOS":"Sin Cambios")),o.createElement(h.default,{style:[v.customButton,v.buttonSecondary,{marginTop:10}],onPress:()=>e.goBack()},o.createElement(g.default,{style:v.buttonTextSecondary},"Volver sin Guardar"))))))}var Ce=r(2081),Ee=r(3158),xe=r(6541);function Be({navigation:e}){const{colors:t}=k(),r=(a=t,n.default.create({container:{flex:1,backgroundColor:"black"},scrollContainer:{flexGrow:1,padding:20,alignItems:"center"},header:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:15,backgroundColor:"#1C1C1E",borderBottomWidth:1,borderBottomColor:a.divider},backButton:{padding:8,borderRadius:8,marginRight:10},title:{fontSize:24,fontWeight:"bold",color:"#3ABFBC"},inputContainer:{width:"100%",marginBottom:20,marginTop:10},label:{fontSize:16,fontWeight:"600",color:"white",marginBottom:8},inputWrapper:{flexDirection:"row",alignItems:"center",backgroundColor:"#1C1C1E",borderRadius:10,borderWidth:1,borderColor:"transparent",paddingHorizontal:15},input:{flex:1,height:50,fontSize:16,color:"white",marginLeft:10},buttonContainer:{width:"100%",marginTop:30,alignItems:"center"},loadingText:{marginTop:10,color:"#A9A9A9"},successMessage:{fontSize:18,fontWeight:"bold",color:"#3ABFBC",textAlign:"center",marginTop:40},icon:{marginRight:5},customButton:{paddingVertical:12,paddingHorizontal:20,borderRadius:10,alignItems:"center",justifyContent:"center",minWidth:"100%",shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.6,shadowRadius:5,elevation:6},buttonPrimary:{backgroundColor:"#3ABFBC"},buttonText:{fontSize:16,fontWeight:"bold",color:"black"}}));var a;const[s,d]=(0,o.useState)(""),[c,u]=(0,o.useState)(""),[m,b]=(0,o.useState)(""),[C,x]=(0,o.useState)(""),[w,A]=(0,o.useState)(!1),[S,T]=(0,o.useState)(!1),v="#A9A9A9",z="#A9A9A9";return o.createElement(p.default,{style:r.container},o.createElement(l.default,{style:r.header},o.createElement(h.default,{onPress:()=>{e.goBack()},style:r.backButton,disabled:w},o.createElement(he.default,{size:24,color:"white"})),o.createElement(g.default,{style:r.title},"Alta de Nuevo Alumno")),o.createElement(re.default,{style:{flex:1},behavior:"height",keyboardVerticalOffset:20},o.createElement(f.default,{contentContainerStyle:r.scrollContainer,keyboardShouldPersistTaps:"handled"},S?o.createElement(l.default,{style:{flex:1,justifyContent:"center",alignItems:"center"}},o.createElement(W.default,{size:80,color:"#3ABFBC"}),o.createElement(g.default,{style:r.successMessage},"\xa1Alumno '",s,"' dado de alta con \xe9xito!"),o.createElement(g.default,{style:r.loadingText},"Volviendo al panel...")):o.createElement(o.Fragment,null,o.createElement(l.default,{style:r.inputContainer},o.createElement(g.default,{style:r.label},"Nombre Completo:"),o.createElement(l.default,{style:r.inputWrapper},o.createElement($.default,{size:20,color:z,style:r.icon}),o.createElement(E.default,{style:r.input,placeholder:"Nombre y apellido del alumno",placeholderTextColor:v,value:s,onChangeText:d,keyboardType:"default",autoCapitalize:"words",editable:!w}))),o.createElement(l.default,{style:r.inputContainer},o.createElement(g.default,{style:r.label},"Correo Electr\xf3nico (Email):"),o.createElement(l.default,{style:r.inputWrapper},o.createElement(Ce.default,{size:20,color:z,style:r.icon}),o.createElement(E.default,{style:r.input,placeholder:"ejemplo@correo.com",placeholderTextColor:v,value:c,onChangeText:u,keyboardType:"email-address",autoCapitalize:"none",editable:!w}))),o.createElement(l.default,{style:r.inputContainer},o.createElement(g.default,{style:r.label},"DNI (Documento Nacional de Identidad):"),o.createElement(l.default,{style:r.inputWrapper},o.createElement(Ee.default,{size:20,color:z,style:r.icon}),o.createElement(E.default,{style:r.input,placeholder:"Solo n\xfameros",placeholderTextColor:v,value:m,onChangeText:b,keyboardType:"numeric",editable:!w}))),o.createElement(l.default,{style:r.inputContainer},o.createElement(g.default,{style:r.label},"Contrase\xf1a Inicial:"),o.createElement(l.default,{style:r.inputWrapper},o.createElement(xe.default,{size:20,color:z,style:r.icon}),o.createElement(E.default,{style:r.input,placeholder:"M\xednimo 6 caracteres",placeholderTextColor:v,value:C,onChangeText:x,secureTextEntry:!0,editable:!w}))),o.createElement(l.default,{style:r.buttonContainer},o.createElement(h.default,{style:[r.customButton,r.buttonPrimary,{opacity:!w&&s.trim()&&c.trim()&&m.trim()&&C.trim()?1:.5}],onPress:async()=>{if(!s.trim()||!c.trim()||!m.trim()||!C.trim())return void y.default.alert("Error","Todos los campos son obligatorios.");if(C.length<6)return void y.default.alert("Error","La contrase\xf1a debe tener al menos 6 caracteres.");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.trim()))if(/^\d+$/.test(m.trim())){A(!0);try{await B.default.post("https://gym-app-backend-e9bn.onrender.com/register/student",{nombre:s.trim(),email:c.trim(),dni:m.trim(),password:C.trim(),rol:"Alumno"});T(!0),setTimeout(()=>{e.goBack()},3e3)}catch(t){console.error("Error al registrar alumno:",t.response?t.response.data:t.message);const e=t.response?.data?.detail;let r=e&&"string"===typeof e?e:"Fallo desconocido en el servidor.";r.includes("DNI ya esta registrado")?r="El DNI proporcionado ya se encuentra registrado.":r.includes("El email ya esta registrado")?r="El Email proporcionado ya se encuentra registrado.":"Network Error"===t.message&&(r="Error de Conexi\xf3n. Aseg\xfarate de que el servidor de FastAPI est\xe9 activo."),y.default.alert("Error de Registro",`Fallo al dar de alta el alumno. Detalle: ${r}`)}finally{A(!1)}}else y.default.alert("Error","El DNI solo debe contener n\xfameros.");else y.default.alert("Error","El formato del correo electr\xf3nico es inv\xe1lido.")},disabled:w||!s.trim()||!c.trim()||!m.trim()||!C.trim()},o.createElement(g.default,{style:r.buttonText},w?"Registrando...":"Registrar Alumno")),w&&o.createElement(i.default,{size:"small",color:"#3ABFBC",style:{marginTop:15}}))))))}var we=r(7366);const Ae=[{label:"Seleccionar Grupo",value:""},{label:"Pectoral",value:"Pectoral"},{label:"Espalda",value:"Espalda"},{label:"Piernas",value:"Piernas"},{label:"Hombro",value:"Hombro"},{label:"Brazos",value:"Brazos"},{label:"Abdomen",value:"Abdomen"},{label:"Gluteos",value:"Gluteos"},{label:"Cardio",value:"Cardio"}],Se=()=>{const e=(0,d.useNavigation)(),{colors:t}=k(),r=(a=t,n.default.create({fullContainer:{flex:1,backgroundColor:"black"},header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:15,backgroundColor:"black",borderBottomWidth:1,borderBottomColor:a.divider,paddingTop:15},backButton:{padding:5},container:{padding:20},card:{backgroundColor:"#1C1C1E",borderRadius:10,padding:20,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.8,shadowRadius:5,elevation:8},title:{fontSize:22,fontWeight:"bold",color:"white",flex:1,textAlign:"center"},label:{fontSize:16,color:"white",fontWeight:"600",marginTop:15,marginBottom:8},input:{backgroundColor:"#1C1C1E",borderRadius:10,padding:12,fontSize:16,color:"white",borderWidth:1,borderColor:a.divider},textArea:{minHeight:100,textAlignVertical:"top"},pickerContainer:{backgroundColor:"#1C1C1E",borderRadius:10,borderWidth:1,borderColor:a.divider,overflow:"hidden",marginBottom:10},picker:{width:"100%",color:"white"},saveButton:{backgroundColor:"#3ABFBC",borderRadius:10,padding:15,alignItems:"center",flexDirection:"row",justifyContent:"center",marginTop:30,shadowColor:"#3ABFBC",shadowOffset:{width:0,height:4},shadowOpacity:.8,shadowRadius:5,elevation:6},saveButtonText:{color:"black",fontSize:18,fontWeight:"bold",marginLeft:10},disabledButton:{backgroundColor:a.divider,opacity:.6,shadowColor:"transparent"}}));var a;const{getToken:s}=(0,o.useContext)(Fe),[c,u]=(0,o.useState)(""),[m,b]=(0,o.useState)(""),[C,x]=(0,o.useState)(""),[w,A]=(0,o.useState)(!1),S="#A9A9A9";return o.createElement(p.default,{style:r.fullContainer},o.createElement(l.default,{style:r.header},o.createElement(h.default,{onPress:()=>e.goBack(),style:r.backButton,disabled:w},o.createElement(he.default,{size:24,color:"white"})),o.createElement(g.default,{style:r.title},"Crear Nuevo Ejercicio"),o.createElement(l.default,{style:{width:24}})),o.createElement(f.default,{contentContainerStyle:r.container},o.createElement(l.default,{style:r.card},o.createElement(g.default,{style:r.label},"Nombre:"),o.createElement(E.default,{style:r.input,placeholder:"Ej: Hip Thrust con Barra",placeholderTextColor:S,value:c,onChangeText:u,editable:!w}),o.createElement(g.default,{style:r.label},"Descripci\xf3n (Opcional):"),o.createElement(E.default,{style:[r.input,r.textArea],placeholder:"Ej: Desarrollo del gl\xfateo mayor.",placeholderTextColor:S,value:m,onChangeText:b,multiline:!0,numberOfLines:4,editable:!w}),o.createElement(g.default,{style:r.label},"Grupo Muscular:"),o.createElement(l.default,{style:r.pickerContainer},o.createElement(we.Picker,{selectedValue:C,onValueChange:e=>x(e),style:r.picker,enabled:!w},Ae.map(e=>o.createElement(we.Picker.Item,{key:e.value,label:e.label,value:e.value,color:""===e.value?S:"white"})))),o.createElement(h.default,{onPress:async()=>{if(!c.trim()||!C.trim())return void y.default.alert("Error","El Nombre y el Grupo Muscular son obligatorios.");A(!0);const t=await s(),r=[{nombre:c.trim(),descripcion:m.trim()||"Sin descripci\xf3n.",grupo_muscular:C}];try{const a=await B.default.post("https://gym-app-backend-e9bn.onrender.com/exercises/",r,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});A(!1),y.default.alert("\xc9xito",`Ejercicio "${a.data[0].nombre}" creado correctamente!`),e.goBack()}catch(a){A(!1);const e=a.response?.data?.detail||a.message||"Fallo en la conexi\xf3n o la API.";y.default.alert("Error al crear ejercicio",e),console.error("Error al agregar ejercicio:",a.response?.data||a)}},disabled:w||!c.trim()||!C.trim(),style:[r.saveButton,(w||!c.trim()||!C.trim())&&r.disabledButton]},w?o.createElement(i.default,{size:"small",color:"black"}):o.createElement(me.default,{size:20,color:"black"}),o.createElement(g.default,{style:r.saveButtonText},w?"Creando...":"Crear Ejercicio")))))},ke="https://gym-app-backend-e9bn.onrender.com",Te=({index:e,exercise:t,updateExercise:r,removeExercise:a,toggleSelector:i,themeColors:s})=>{const d=(c=s,n.default.create({card:{backgroundColor:c.card,borderRadius:12,padding:15,marginBottom:15,borderLeftWidth:5,borderLeftColor:c.primary,elevation:4,shadowColor:c.isDark?"#000":"#444",shadowOffset:{width:0,height:2},shadowOpacity:c.isDark?.3:.1,shadowRadius:3},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},title:{fontSize:16,fontWeight:"700",color:c.textPrimary,opacity:.7},deleteButton:{padding:5},selectButton:{backgroundColor:c.highlight,borderRadius:8,paddingHorizontal:15,paddingVertical:12,marginBottom:15,flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},selectButtonText:{color:c.textPrimary,fontSize:17,fontWeight:"600",marginLeft:10,flexShrink:1},row:{flexDirection:"row",justifyContent:"space-between",marginTop:5},compactLabel:{fontSize:12,color:c.textSecondary,marginBottom:3,fontWeight:"bold",textAlign:"center",textTransform:"uppercase"},inputGroup:{width:"31%",alignItems:"center"},input:{height:40,backgroundColor:c.background,borderColor:c.divider,borderWidth:1,borderRadius:6,paddingHorizontal:5,fontSize:14,color:c.textPrimary,textAlign:"center",width:"100%"}}));var c;const u=(t,a)=>{r(e,t,a)},m=s.isDark?s.textSecondary:"#A0A0A0",f=t.exercise_id?s.primary:s.danger,p=t.exercise_id?s.highlight:s.isDark?"#2D2D2D":"#FEECEC";return o.createElement(l.default,{style:d.card},o.createElement(l.default,{style:d.header},o.createElement(g.default,{style:d.title},"Ejercicio #",e+1),o.createElement(h.default,{onPress:()=>a(e),style:d.deleteButton},o.createElement(F.default,{size:20,color:s.danger}))),o.createElement(h.default,{style:[d.selectButton,!t.exercise_id&&{borderColor:s.danger,backgroundColor:p}],onPress:()=>i(e)},o.createElement(ce.default,{size:20,color:f}),o.createElement(g.default,{style:[d.selectButtonText,!t.exercise_id&&{color:s.danger}],numberOfLines:1,ellipsizeMode:"tail"},t.name||"Toca para Seleccionar Ejercicio")),o.createElement(l.default,{style:d.row},o.createElement(l.default,{style:d.inputGroup},o.createElement(g.default,{style:d.compactLabel},"Series"),o.createElement(E.default,{style:d.input,placeholder:"3",placeholderTextColor:m,keyboardType:"numeric",value:t.series,onChangeText:e=>u("series",e)})),o.createElement(l.default,{style:d.inputGroup},o.createElement(g.default,{style:d.compactLabel},"Repeticiones"),o.createElement(E.default,{style:d.input,placeholder:"10-12",placeholderTextColor:m,keyboardType:"default",value:t.repetitions,onChangeText:e=>u("repetitions",e)})),o.createElement(l.default,{style:d.inputGroup},o.createElement(g.default,{style:d.compactLabel},"Peso"),o.createElement(E.default,{style:d.input,placeholder:"20 kg",placeholderTextColor:m,keyboardType:"default",value:t.peso,onChangeText:e=>u("peso",e)}))))};function ve({navigation:e}){const{colors:t}=k(),r=(a=t,n.default.create({container:{flex:1,backgroundColor:a.background},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:a.background},content:{padding:20,paddingBottom:100},subHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:20,paddingVertical:10,backgroundColor:a.card,borderBottomWidth:1,borderBottomColor:a.divider},actionButton:{flexDirection:"row",alignItems:"center",paddingVertical:10,paddingHorizontal:15,borderRadius:8,justifyContent:"center",width:"48%"},actionButtonText:{color:a.card,fontWeight:"bold",marginLeft:8,fontSize:14},selectorActionButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:a.success,borderRadius:8,paddingVertical:10,marginHorizontal:20,marginTop:10,marginBottom:15},cancelButton:{backgroundColor:a.danger},label:{fontSize:16,fontWeight:"600",color:a.textPrimary,marginBottom:5,marginTop:15},input:{height:50,backgroundColor:a.highlight,borderColor:a.divider,borderWidth:1,borderRadius:8,paddingHorizontal:15,fontSize:16,marginBottom:15,color:a.textPrimary},textArea:{height:80,textAlignVertical:"top",paddingTop:10},sectionTitle:{fontSize:20,fontWeight:"bold",color:a.textPrimary,marginTop:25,marginBottom:15},floatingButton:{position:"absolute",bottom:20,right:20,backgroundColor:a.success,padding:15,borderRadius:50,flexDirection:"row",alignItems:"center",elevation:6,shadowColor:a.success,shadowOffset:{width:0,height:4},shadowOpacity:.3,shadowRadius:4},floatingButtonText:{color:a.card,fontWeight:"bold",marginLeft:8,fontSize:16},selectorContainer:{flex:1,backgroundColor:a.background,paddingTop:0},selectorHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:15,borderBottomWidth:1,borderBottomColor:a.divider,backgroundColor:a.card},selectorTitle:{fontSize:20,fontWeight:"bold",color:a.textPrimary,flex:1,textAlign:"center"},selectorSearchInput:{height:45,backgroundColor:a.highlight,borderColor:a.divider,borderWidth:1,borderRadius:25,paddingHorizontal:20,marginHorizontal:20,marginTop:10,marginBottom:15,fontSize:16,color:a.textPrimary},selectorList:{paddingHorizontal:0,paddingVertical:10},selectorItem:{paddingVertical:15,paddingHorizontal:20,borderBottomWidth:1,borderBottomColor:a.divider,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},selectorItemName:{fontSize:17,fontWeight:"600",color:a.textPrimary,flexShrink:1},selectorItemGroup:{fontSize:14,color:a.textSecondary,marginLeft:10},closeSelectorButton:{padding:5},screenHeader:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:20,paddingVertical:10,backgroundColor:a.card,borderBottomWidth:1,borderBottomColor:a.divider},screenTitle:{fontSize:18,fontWeight:"bold",color:a.textPrimary,textAlign:"center"}}));var a;const s=(0,d.useRoute)(),{routineId:c}=s.params||{},[u,m]=(0,o.useState)({name:"",description:"",exercises:[]}),[b,C]=(0,o.useState)([]),[x,w]=(0,o.useState)(!1),[A,S]=(0,o.useState)(null),[T,v]=(0,o.useState)(""),[z,I]=(0,o.useState)(!0),[D,P]=(0,o.useState)(!1),[W,F]=(0,o.useState)(null),{getToken:N}=(0,o.useContext)(Fe),j=(e,t)=>{m(r=>Object.assign({},r,{[e]:t}))},L=(e,t,r)=>{m(a=>{const o=[...a.exercises];return o[e]&&(o[e]=Object.assign({},o[e],{[t]:r})),Object.assign({},a,{exercises:o})})};(0,o.useEffect)(()=>{(async()=>{if(!c)return F("Error: ID de rutina no proporcionado para edici\xf3n."),void I(!1);I(!0),F(null);try{const e={Authorization:`Bearer ${await N()}`},t=await B.default.get(`${ke}/exercises/`,{headers:e});C(t.data);const r=(await B.default.get(`${ke}/routines/${c}`,{headers:e})).data,a=r.exercise_links.sort((e,t)=>e.order-t.order).map(e=>({exercise_id:e.exercise_id,name:e.exercise?.nombre||"Ejercicio Desconocido",series:String(e.sets||""),repetitions:String(e.repetitions||""),peso:e.peso||""}));m({name:r.nombre,description:r.descripcion||"",exercises:a})}catch(e){console.error("Error loading data:",e.response?e.response.data:e.message),F(`Error de conexi\xf3n al cargar datos. Rutina con ID ${c} no encontrada.`)}finally{I(!1)}})(),e.setOptions({headerLeft:()=>null})},[c]);const O=e=>{y.default.alert("Confirmar Eliminaci\xf3n",`\xbfEst\xe1s seguro de que quieres eliminar el ejercicio #${e+1}?`,[{text:"Cancelar",style:"cancel"},{text:"Eliminar",style:"destructive",onPress:()=>{const t=u.exercises.filter((t,r)=>r!==e);j("exercises",t)}}])},$=e=>{S(e),w(!0)},V=()=>{w(!1),e.navigate("ExercisesAdd")},H=b.filter(e=>e.nombre.toLowerCase().includes(T.toLowerCase())||e.grupo_muscular&&e.grupo_muscular.toLowerCase().includes(T.toLowerCase()));if(z)return o.createElement(l.default,{style:r.loadingContainer},o.createElement(i.default,{size:"large",color:t.primary}),o.createElement(g.default,{style:{marginTop:10,color:t.textSecondary}},"Cargando datos de edici\xf3n..."));if(W)return o.createElement(l.default,{style:r.loadingContainer},o.createElement(g.default,{style:{color:t.danger,textAlign:"center",margin:20}},W),o.createElement(h.default,{onPress:()=>e.goBack(),style:[r.actionButton,r.cancelButton,{backgroundColor:t.primary,width:150}]},o.createElement(g.default,{style:r.actionButtonText},"Volver")));const _=t.isDark?t.textSecondary:"#A0A0A0";return x?o.createElement(p.default,{style:r.selectorContainer},o.createElement(l.default,{style:r.selectorHeader},o.createElement(h.default,{onPress:()=>w(!1),style:r.closeSelectorButton},o.createElement(R.default,{size:28,color:t.danger})),o.createElement(g.default,{style:r.selectorTitle},"Seleccionar Ejercicio"),o.createElement(l.default,{style:{width:28}})),o.createElement(E.default,{style:r.selectorSearchInput,placeholder:"Buscar (Nombre o Grupo Muscular)",placeholderTextColor:t.textSecondary,value:T,onChangeText:v}),o.createElement(h.default,{onPress:V,style:[r.selectorActionButton,{backgroundColor:t.success}],disabled:D},o.createElement(ue.default,{size:18,color:t.card}),o.createElement(g.default,{style:r.actionButtonText},"Agregar Nuevo Ejercicio al Cat\xe1logo")),o.createElement(f.default,{contentContainerStyle:r.selectorList},H.length>0?H.map(e=>o.createElement(h.default,{key:e.id.toString(),style:r.selectorItem,onPress:()=>((e,t)=>{null!==A&&(u.exercises.some((t,r)=>r!==A&&t.exercise_id===e)&&y.default.alert("Advertencia","Este ejercicio ya est\xe1 en la rutina. Puedes editar sus series/repeticiones."),L(A,"exercise_id",e),L(A,"name",t));w(!1),v(""),S(null)})(e.id,e.nombre)},o.createElement(g.default,{style:r.selectorItemName},e.nombre),o.createElement(g.default,{style:r.selectorItemGroup},"Grupo: ",e.grupo_muscular))):o.createElement(g.default,{style:{textAlign:"center",color:t.textSecondary,marginTop:20}},"No se encontraron ejercicios con ese filtro."))):o.createElement(p.default,{style:r.container},o.createElement(l.default,{style:r.screenHeader},o.createElement(g.default,{style:r.screenTitle},"Editar Rutina: ",u.name)),o.createElement(l.default,{style:r.subHeader},o.createElement(h.default,{onPress:()=>e.goBack(),style:[r.actionButton,r.cancelButton],disabled:D},o.createElement(R.default,{size:18,color:t.card}),o.createElement(g.default,{style:r.actionButtonText},"Cancelar")),o.createElement(h.default,{onPress:async()=>{if(u.name.trim()?0===u.exercises.length?(y.default.alert("Error",`La rutina "${u.name}" debe tener al menos un ejercicio.`),0):!u.exercises.find(e=>{if(!e.exercise_id)return!0;const t=e.series?e.series.trim():"",r=parseInt(t);return!!(isNaN(r)||r<=0)||0===(e.repetitions?e.repetitions.trim():"").length})||(y.default.alert("Error de Validaci\xf3n",`En "${u.name}": Todos los ejercicios deben estar seleccionados y tener Series (entero positivo) y Repeticiones no vac\xedas.`),0):(y.default.alert("Error","El nombre de la rutina no puede estar vac\xedo."),0)){P(!0);try{const t={Authorization:`Bearer ${await N()}`},r={nombre:u.name.trim(),descripcion:u.description.trim()||"",exercises:u.exercises.map((e,t)=>({exercise_id:e.exercise_id,sets:parseInt(e.series.trim()),repetitions:e.repetitions.trim(),peso:e.peso.trim()||"N/A",order:t+1}))};await B.default.patch(`${ke}/routines/${c}`,r,{headers:t}),y.default.alert("\xc9xito de Edici\xf3n",`Rutina "${u.name.trim()}" actualizada exitosamente.`),e.goBack()}catch(t){console.error("Error saving routine (API):",t.message,JSON.stringify(t.response?t.response.data:t.message));let e="Fallo desconocido al guardar la rutina.";t.response&&t.response.data&&t.response.data.detail?(Array.isArray(t.response.data.detail)||"string"===typeof t.response.data.detail)&&(e=`Error de FastAPI: ${JSON.stringify(t.response.data.detail)}`):"Network Error"===t.message&&(e="Error de red: No se pudo conectar al servidor API."),y.default.alert("Error de Edici\xf3n",e)}finally{P(!1)}}},style:[r.actionButton,{backgroundColor:t.warning}],disabled:D||!u.name.trim()||0===u.exercises.length},D?o.createElement(i.default,{size:"small",color:t.card}):o.createElement(me.default,{size:18,color:t.card}),o.createElement(g.default,{style:r.actionButtonText},D?"Guardando...":"Guardar Cambios"))),o.createElement(re.default,{style:{flex:1},behavior:"height",keyboardVerticalOffset:20},o.createElement(f.default,{contentContainerStyle:r.content},o.createElement(g.default,{style:r.label},"Nombre de la Rutina:"),o.createElement(E.default,{style:r.input,placeholder:"Ej: Rutina Hipertrofia D\xeda A",placeholderTextColor:_,value:u.name,onChangeText:e=>j("name",e),editable:!D}),o.createElement(g.default,{style:r.label},"Descripci\xf3n (Opcional):"),o.createElement(E.default,{style:[r.input,r.textArea],placeholder:"Ej: Fase de volumen 4 semanas",placeholderTextColor:_,value:u.description,onChangeText:e=>j("description",e),multiline:!0,editable:!D}),o.createElement(g.default,{style:r.sectionTitle},"Ejercicios (",u.exercises.length,"):"),o.createElement(l.default,null,u.exercises.map((e,r)=>o.createElement(Te,{key:r.toString(),index:r,exercise:e,updateExercise:L,removeExercise:O,toggleSelector:$,themeColors:t}))))),o.createElement(h.default,{onPress:()=>{const e=[...u.exercises,{exercise_id:null,name:"",series:"",repetitions:"",peso:""}];j("exercises",e)},style:r.floatingButton,disabled:D||W||0===b.length},o.createElement(ue.default,{size:24,color:t.card}),o.createElement(g.default,{style:r.floatingButtonText},"A\xf1adir Ejercicio")))}const ze=({isVisible:e,onClose:t,navigation:r,signOut:a,themeColors:n,styles:i})=>o.createElement(C.default,{animationType:"fade",transparent:!0,visible:e,onRequestClose:t},o.createElement(h.default,{style:i.modalOverlay,activeOpacity:1,onPressOut:t},o.createElement(l.default,{style:i.menuContainer},o.createElement(p.default,{style:{flex:1,backgroundColor:"#1C1C1E"}}," ",o.createElement(f.default,{contentContainerStyle:i.menuScroll},o.createElement(g.default,{style:[i.menuTitle,{color:"#3ABFBC",borderBottomColor:n.divider}]}," ","Men\xfa de Alumno"),o.createElement(h.default,{style:[i.menuItem,{borderBottomColor:n.divider}],onPress:()=>{t(),r.navigate("ChangePassword")}},o.createElement(V.default,{size:18,color:"white"})," ",o.createElement(g.default,{style:[i.menuItemText,{color:"white"}]},"Cambiar Contrase\xf1a")," "),o.createElement(h.default,{style:[i.menuItem,{borderBottomColor:n.divider}],onPress:()=>{y.default.alert("Cerrar Sesi\xf3n","\xbfEst\xe1s seguro que quieres cerrar sesi\xf3n?",[{text:"Cancelar",style:"cancel"},{text:"Cerrar",onPress:a,style:"destructive"}])}},o.createElement(_.default,{size:18,color:n.danger}),o.createElement(g.default,{style:[i.menuItemTextLogout,{color:n.danger}]},"Cerrar Sesi\xf3n")))),o.createElement(h.default,{style:[i.menuItemClose,{backgroundColor:n.divider}],onPress:t},o.createElement(g.default,{style:i.menuItemTextClose},"Cerrar Men\xfa"))))),Ie=({assignment:e,styles:t,themeColors:r})=>{const[a,n]=(0,o.useState)(!1),i=e.routine,s=i?.exercise_links?i.exercise_links.length:0,d=e.is_active?"#3ABFBC":r.warning,c=e.is_active?"ACTIVA":"INACTIVA",u=i?.routine_group?.fecha_vencimiento?`Vence: ${new Date(i.routine_group.fecha_vencimiento).toLocaleDateString("es-AR")}`:"Vencimiento: N/A",m=i?.routine_group?.nombre;let f=i?.nombre??"Rutina Sin Titulo";m&&f.startsWith(m)&&(f=f.substring(m.length).trim(),f.startsWith("-")&&(f=f.substring(1).trim()),""===f&&(f=i?.descripcion?.match(/D\xeda (\d+)/)?.[0]||"D\xeda de Entrenamiento"));return o.createElement(l.default,{style:t.routineCardContainer},o.createElement(l.default,{style:[t.statusBar,{backgroundColor:d}]},o.createElement(g.default,{style:[t.statusText,{color:d===r.warning?"black":"white"}]},c)),o.createElement(h.default,{style:t.assignmentContent,onPress:()=>n(!a),activeOpacity:.8},o.createElement(l.default,{style:t.cardHeader},o.createElement(l.default,{style:{flex:1}},o.createElement(g.default,{style:t.routineTitle},f),o.createElement(g.default,{style:t.routineGroup},u),o.createElement(g.default,{style:t.assignedBy},"Profesor: ",e.professor?.nombre??"Desconocido"),o.createElement(g.default,{style:{marginTop:5,color:"#A9A9A9",fontSize:13,fontWeight:"500"}},s," EJERCICIOS")),a?o.createElement(z.default,{size:24,color:"#3ABFBC"}):o.createElement(I.default,{size:24,color:"#3ABFBC"})),a&&o.createElement(l.default,{style:t.exerciseListContainer},o.createElement(g.default,{style:{fontSize:13,fontWeight:"bold",color:"white",marginBottom:10}},"Detalle de Ejercicios:"),i.exercise_links.sort((e,t)=>e.order-t.order).map((e,r)=>o.createElement(l.default,{key:e.id||r,style:t.exerciseItem},o.createElement(g.default,{style:t.exerciseName},e.order,". ",e.exercise?.nombre??"Ejercicio Desconocido"),o.createElement(l.default,{style:t.detailsRow},o.createElement(l.default,{style:t.detailItem},o.createElement(g.default,{style:t.detailLabel},"Sets:"),o.createElement(g.default,{style:[t.detailValue,{color:"#3ABFBC"}]},e.sets)),o.createElement(l.default,{style:t.detailItem},o.createElement(g.default,{style:t.detailLabel},"Reps:"),o.createElement(g.default,{style:[t.detailValue,{color:"#3ABFBC"}]},e.repetitions)),o.createElement(l.default,{style:t.detailItem},o.createElement(g.default,{style:t.detailLabel},"Peso:"),o.createElement(g.default,{style:[t.detailValue,{color:"#3ABFBC"}]},e.peso||"-"))))))))};function De({navigation:e}){const{colors:t}=k(),r=Pe(t),{signOut:a,getToken:n,userProfile:s}=(0,o.useContext)(Fe),[d,c]=(0,o.useState)([]),[u,m]=(0,o.useState)(!0),[b,C]=(0,o.useState)(null),[E,x]=(0,o.useState)(!1),w=async()=>{m(!0),C(null);try{const e=await n();if(!e)return void a();const t=(await B.default.get("https://gym-app-backend-e9bn.onrender.com/students/me/routine",{headers:{Authorization:`Bearer ${e}`}})).data;if(t&&t.length>0){const e=t.filter(e=>null!==e.routine);e.sort((e,t)=>e.routine.id-t.routine.id),c(e),0===e.length&&C("No tienes ninguna rutina activa asignada.")}else c([]),C("No tienes ninguna rutina activa asignada.")}catch(e){console.error("Error al cargar la rutina del alumno:",e.response?e.response.data:e.message),!e.response||404!==e.response.status&&"No tienes ninguna rutina activa asignada."!==e.response.data?.detail?(y.default.alert("Error de Conexi\xf3n","Fallo al cargar la rutina. Verifica tu conexi\xf3n o backend."),C("Error al cargar la rutina. Revisa tu conexi\xf3n.")):C("No tienes ninguna rutina activa asignada.")}finally{setTimeout(()=>m(!1),300)}};(0,o.useEffect)(()=>{const t=e.addListener("focus",()=>{w()});return w(),t},[]);const A=(0,o.useMemo)(()=>{const e={};return d.forEach(t=>{const r=t.routine,a=r?.routine_group?.id||"NoGroup",o=r?.routine_group?.nombre||"Rutinas Individuales";e[a]||(e[a]={groupName:o,assignments:[]}),e[a].assignments.push(t)}),e},[d]);return u?o.createElement(p.default,{style:r.loadingContainer},o.createElement(i.default,{size:"large",color:"#3ABFBC"}),o.createElement(g.default,{style:{marginTop:10,color:t.textSecondary}},"Cargando tus rutinas...")):o.createElement(p.default,{style:r.container},o.createElement(ze,{isVisible:E,onClose:()=>x(!1),navigation:e,signOut:a,themeColors:t,styles:r}),o.createElement(l.default,{style:r.header},o.createElement(h.default,{onPress:()=>x(!0),style:r.iconButton},o.createElement(j.default,{size:24,color:"white"})),o.createElement(g.default,{style:r.headerTitle},"Bienvenido/a ",s?.nombre?.split(" ")[0]||"Alumno/a"),o.createElement(l.default,{style:r.headerButtons},o.createElement(h.default,{onPress:()=>{w()},style:r.iconButton,disabled:u},o.createElement(L.default,{size:24,color:"#3ABFBC"})))),o.createElement(f.default,{contentContainerStyle:r.content},o.createElement(l.default,{style:r.mainContentHeader},o.createElement(g.default,{style:r.mainTitle},"Mi Plan de Entrenamiento"),o.createElement(g.default,{style:{color:"#A9A9A9"}},"Rutinas Activas (",d.length,")"),b&&"No tienes ninguna rutina activa asignada."!==b&&o.createElement(g.default,{style:r.errorText},b)),d.length>0?Object.entries(A).map(([e,a])=>o.createElement(l.default,{key:e},o.createElement(g.default,{style:r.groupHeaderTitle},a.groupName," (",a.assignments.length," Rutinas)"),a.assignments.map((e,a)=>o.createElement(Ie,{key:e.id?.toString()??a.toString(),assignment:e,styles:r,themeColors:t})))):o.createElement(l.default,{style:r.noRoutineContainer},o.createElement(g.default,{style:r.noRoutineText},"\xa1Libre de Rutinas!"),o.createElement(g.default,{style:r.noRoutineSubText},"P\xeddele a tu profesor que te asigne un nuevo plan."))))}const Pe=e=>n.default.create({container:{flex:1,backgroundColor:"black"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"black"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:15,paddingTop:15,backgroundColor:"black",borderBottomWidth:1,borderBottomColor:e.divider,elevation:0},headerTitle:{fontSize:18,fontWeight:"bold",color:"white",flex:1,textAlign:"center",paddingHorizontal:10},headerButtons:{flexDirection:"row",gap:15},iconButton:{padding:8,borderRadius:8,justifyContent:"center",alignItems:"center",backgroundColor:"#1C1C1E"},content:{flexGrow:1,padding:20},mainContentHeader:{marginBottom:10},mainTitle:{fontSize:24,fontWeight:"bold",color:"white",marginBottom:5},groupHeaderTitle:{fontSize:22,fontWeight:"bold",color:"#3ABFBC",marginTop:20,marginBottom:10,borderBottomWidth:1,borderBottomColor:e.divider,paddingBottom:5},errorText:{color:e.danger,fontWeight:"600",marginTop:10,textAlign:"center",backgroundColor:e.danger+"30",padding:10,borderRadius:8,marginBottom:20},noRoutineContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40,backgroundColor:"#1C1C1E",borderRadius:10,marginTop:50,borderWidth:1,borderColor:e.warning},noRoutineText:{fontSize:22,fontWeight:"bold",color:e.warning,marginBottom:10,textAlign:"center"},noRoutineSubText:{fontSize:16,color:"#A9A9A9",textAlign:"center"},routineCardContainer:{flexDirection:"row",backgroundColor:"#1C1C1E",borderRadius:10,marginBottom:15,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.8,shadowRadius:5,elevation:5,overflow:"hidden"},statusBar:{width:30,justifyContent:"center",alignItems:"center",paddingVertical:10},statusText:{fontSize:14,fontWeight:"bold",color:"white",transform:[{rotate:"-90deg"}],width:100,textAlign:"center"},assignmentContent:{flex:1},cardHeader:{padding:15,flexDirection:"row",justifyContent:"space-between",alignItems:"center",flex:1},routineTitle:{fontSize:18,fontWeight:"bold",color:"white",marginBottom:5},routineGroup:{fontSize:13,color:"#A9A9A9",marginBottom:2},assignedBy:{fontSize:12,color:"#A9A9A9",fontStyle:"italic",marginTop:5},exerciseListContainer:{paddingTop:15,paddingHorizontal:15,paddingBottom:15,borderTopWidth:1,borderTopColor:e.divider,backgroundColor:"black"},exerciseItem:{paddingLeft:10,paddingVertical:8,borderLeftWidth:2,borderLeftColor:"#3ABFBC",marginBottom:8,backgroundColor:"#1C1C1E",borderRadius:5},exerciseName:{fontSize:16,fontWeight:"700",color:"white",marginBottom:5},detailsRow:{flexDirection:"row",justifyContent:"flex-start",gap:15,marginTop:5},detailItem:{flexDirection:"row",alignItems:"center",backgroundColor:"black",borderRadius:6,paddingHorizontal:8,paddingVertical:4},detailLabel:{fontSize:12,color:"#A9A9A9",marginRight:4,fontWeight:"500"},detailValue:{fontSize:14,fontWeight:"bold",color:"#3ABFBC"},modalOverlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.7)",justifyContent:"flex-start",alignItems:"flex-start"},menuContainer:{width:280,height:"100%",backgroundColor:"#1C1C1E",position:"absolute",left:0,top:0,shadowColor:"#000",shadowOffset:{width:2,height:0},shadowOpacity:1,shadowRadius:5,elevation:10},menuScroll:{paddingBottom:70},menuTitle:{fontSize:18,fontWeight:"bold",paddingVertical:10,marginBottom:10,borderBottomWidth:1,borderBottomColor:e.divider,color:"#3ABFBC",paddingHorizontal:15},menuItem:{paddingVertical:12,paddingHorizontal:15,borderBottomWidth:1,borderBottomColor:e.divider,flexDirection:"row",alignItems:"center",gap:10},menuItemClose:{position:"absolute",bottom:0,left:0,right:0,padding:15,backgroundColor:e.divider,alignItems:"center"},menuItemText:{fontSize:15,fontWeight:"600",color:"white"},menuItemTextLogout:{fontSize:15,fontWeight:"600",color:e.danger},menuItemTextClose:{fontSize:15,fontWeight:"600",color:"white"}});function Re({navigation:e}){const{colors:t}=k(),r=n.default.create({safeArea:{flex:1,backgroundColor:"black"},container:{padding:25,alignItems:"center",flexGrow:1,justifyContent:"center"},title:{fontSize:28,fontWeight:"bold",color:"white",marginBottom:10,textAlign:"center"},subtitle:{fontSize:16,color:"#A9A9A9",marginBottom:40,textAlign:"center"},inputWrapper:{flexDirection:"row",alignItems:"center",width:"100%",height:50,backgroundColor:"#1C1C1E",borderRadius:10,paddingHorizontal:15,marginBottom:20,borderWidth:1,borderColor:"transparent"},input:{flex:1,fontSize:16,color:"white",marginLeft:10},button:{width:"100%",backgroundColor:"#3ABFBC",padding:15,borderRadius:10,alignItems:"center",marginTop:20,shadowColor:"#3ABFBC",shadowOffset:{width:0,height:4},shadowOpacity:.8,shadowRadius:5,elevation:6},buttonText:{color:"black",fontSize:18,fontWeight:"bold"},backButton:{marginTop:30,padding:10},backButtonText:{color:"#A9A9A9",fontSize:16,fontWeight:"600"}}),[a,s]=(0,o.useState)(""),[d,c]=(0,o.useState)(!1),u="#A9A9A9";return o.createElement(p.default,{style:r.safeArea},o.createElement(f.default,{contentContainerStyle:r.container},o.createElement(g.default,{style:r.title},"\xbfOlvidaste tu Contrase\xf1a?"),o.createElement(g.default,{style:r.subtitle},"Ingresa tu DNI o Email para que podamos enviarte instrucciones para restablecerla."),o.createElement(l.default,{style:r.inputWrapper},o.createElement($.default,{size:20,color:u}),o.createElement(E.default,{style:r.input,placeholder:"DNI o Email",placeholderTextColor:"#A9A9A9",value:a,onChangeText:s,keyboardType:"email-address",autoCapitalize:"none",editable:!d})),d?o.createElement(i.default,{size:"large",color:"#3ABFBC",style:{marginTop:20}}):o.createElement(h.default,{style:r.button,onPress:async()=>{if(a.trim()){c(!0);try{await new Promise(e=>setTimeout(e,1500)),y.default.alert("\xa1Solicitud Enviada!","Si el DNI/Email es correcto, recibir\xe1s un correo con instrucciones para restablecer tu contrase\xf1a."),e.goBack()}catch(t){console.error("Error al solicitar restablecimiento:",t.response?t.response.data:t.message);const e="No se pudo procesar la solicitud. Por favor, verifica el identificador e int\xe9ntalo de nuevo m\xe1s tarde.";y.default.alert("Error",e)}finally{c(!1)}}else y.default.alert("Error","Por favor, ingresa tu DNI o Email.")},disabled:!a.trim()},o.createElement(g.default,{style:r.buttonText},"Restablecer Contrase\xf1a")),o.createElement(h.default,{onPress:()=>e.goBack(),style:r.backButton},o.createElement(g.default,{style:r.backButtonText},o.createElement(he.default,{size:14,color:u,style:{marginRight:5}})," Volver al Inicio de Sesi\xf3n"))))}const We=e=>{try{const t=(0,m.jwtDecode)(e);return{rol:t.rol,nombre:t.nombre}}catch(t){return console.error("Error decodificando token:",t),{rol:null,nombre:null}}},Fe=(0,o.createContext)();function Ne(){const{signIn:e}=(0,o.useContext)(Fe);return o.createElement(se,{signIn:e,API_URL:"https://gym-app-backend-e9bn.onrender.com"})}const je=(0,c.createNativeStackNavigator)();n.default.create({});(0,a.default)(function(){const[e,t]=(0,o.useState)(!0),[r,a]=(0,o.useState)(null),[n,c]=(0,o.useState)(null),[m,g]=(0,o.useState)(null),f="dark"===(0,s.default)(),p=f?"#60A5FA":"#007AFF",b=f?"#1F2937":"#FFFFFF",h=f?"#121212":"#F0F4F8",y=(0,o.useMemo)(()=>({signIn:async e=>{try{await u.default.setItem("user_token",e);const{rol:t,nombre:r}=We(e);c(t),g({nombre:r}),a(e)}catch(t){console.error("Error guardando token o decodificando:",t)}},signOut:async()=>{try{await u.default.removeItem("user_token"),a(null),c(null),g(null)}catch(e){console.error("Error borrando token",e)}},getToken:async()=>{try{return await u.default.getItem("user_token")}catch(e){return console.error("Error obteniendo token",e),null}},userProfile:m}),[r,m]);if((0,o.useEffect)(()=>{(async()=>{let e=null;try{e=await u.default.getItem("user_token")}catch(r){console.error("Error leyendo token",r)}if(e){const{rol:t,nombre:r}=We(e);c(t),g({nombre:r})}a(e),t(!1)})()},[]),e)return o.createElement(l.default,{style:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:h}},o.createElement(i.default,{size:"large",color:p}));const C=null==r?"Login":"Profesor"===n?"ProfessorPanel":"StudentRoutine";return o.createElement(Fe.Provider,{value:y},o.createElement(T,null,o.createElement(d.NavigationContainer,null,o.createElement(je.Navigator,{screenOptions:{headerShown:!0,headerTintColor:p,headerStyle:{backgroundColor:b},headerTitleStyle:{color:p}},initialRouteName:C},null==r?o.createElement(o.Fragment,null,o.createElement(je.Screen,{name:"Login",component:Ne,options:{title:"Ingresar",headerShown:!1}}),o.createElement(je.Screen,{name:"ForgotPassword",component:Re,options:{title:"Olvid\xe9 mi Contrase\xf1a",headerShown:!1}})):"Profesor"===n?o.createElement(o.Fragment,null,o.createElement(je.Screen,{name:"ProfessorPanel",component:te,options:{title:"Panel Profesor",headerShown:!1}}),o.createElement(je.Screen,{name:"RoutineCreation",component:pe,options:{title:"Crear Rutina"}}),o.createElement(je.Screen,{name:"StudentDetails",component:ye,options:{title:"Detalles del Alumno"}}),o.createElement(je.Screen,{name:"ChangePassword",component:be,options:{title:"Cambiar Contrase\xf1a"}}),o.createElement(je.Screen,{name:"AddStudent",component:Be,options:{title:"Registrar Alumno",headerShown:!1}}),o.createElement(je.Screen,{name:"ExercisesAdd",component:Se,options:{title:"A\xf1adir Ejercicio",headerShown:!1}}),o.createElement(je.Screen,{name:"RoutineEditScreen",component:ve,options:{title:"Editar Rutina",headerShown:!1}})):o.createElement(o.Fragment,null,o.createElement(je.Screen,{name:"StudentRoutine",component:De,options:{title:"Mi Rutina",headerShown:!1}}),o.createElement(je.Screen,{name:"ChangePassword",component:be,options:{title:"Cambiar Contrase\xf1a"}}))))))})},8704:(e,t,r)=>{e.exports=r.p+"static/media/logoND.ffa1d6dcbc803c0c6a43.png"}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}r.m=e,(()=>{var e=[];r.O=(t,a,o,n)=>{if(!a){var l=1/0;for(c=0;c<e.length;c++){for(var[a,o,n]=e[c],i=!0,s=0;s<a.length;s++)(!1&n||l>=n)&&Object.keys(r.O).every(e=>r.O[e](a[s]))?a.splice(s--,1):(i=!1,n<l&&(l=n));if(i){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[a,o,n]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="./",(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var o,n,[l,i,s]=a,d=0;if(l.some(t=>0!==e[t])){for(o in i)r.o(i,o)&&(r.m[o]=i[o]);if(s)var c=s(r)}for(t&&t(a);d<l.length;d++)n=l[d],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(c)},a=self.webpackChunkweb=self.webpackChunkweb||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=r.O(void 0,[177],()=>r(4180));a=r.O(a)})();
//# sourceMappingURL=main.af436ef4.js.map